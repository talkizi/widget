(function(){"use strict";try{if(typeof document<"u"){var r=document.createElement("style");r.appendChild(document.createTextNode('/*! tailwindcss v4.1.10 | MIT License | https://tailwindcss.com */@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-scale-x:1;--tw-scale-y:1;--tw-scale-z:1;--tw-rotate-x:initial;--tw-rotate-y:initial;--tw-rotate-z:initial;--tw-skew-x:initial;--tw-skew-y:initial;--tw-space-y-reverse:0;--tw-space-x-reverse:0;--tw-border-style:solid;--tw-gradient-position:initial;--tw-gradient-from:#0000;--tw-gradient-via:#0000;--tw-gradient-to:#0000;--tw-gradient-stops:initial;--tw-gradient-via-stops:initial;--tw-gradient-from-position:0%;--tw-gradient-via-position:50%;--tw-gradient-to-position:100%;--tw-leading:initial;--tw-font-weight:initial;--tw-tracking:initial;--tw-shadow:0 0 #0000;--tw-shadow-color:initial;--tw-shadow-alpha:100%;--tw-inset-shadow:0 0 #0000;--tw-inset-shadow-color:initial;--tw-inset-shadow-alpha:100%;--tw-ring-color:initial;--tw-ring-shadow:0 0 #0000;--tw-inset-ring-color:initial;--tw-inset-ring-shadow:0 0 #0000;--tw-ring-inset:initial;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-offset-shadow:0 0 #0000;--tw-backdrop-blur:initial;--tw-backdrop-brightness:initial;--tw-backdrop-contrast:initial;--tw-backdrop-grayscale:initial;--tw-backdrop-hue-rotate:initial;--tw-backdrop-invert:initial;--tw-backdrop-opacity:initial;--tw-backdrop-saturate:initial;--tw-backdrop-sepia:initial;--tw-duration:initial;--tw-ease:initial}}}@layer theme{:root,:host{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-red-100:oklch(93.6% .032 17.717);--color-red-500:oklch(63.7% .237 25.331);--color-red-600:oklch(57.7% .245 27.325);--color-red-700:oklch(50.5% .213 27.518);--color-red-900:oklch(39.6% .141 25.723);--color-yellow-500:oklch(79.5% .184 86.047);--color-yellow-600:oklch(68.1% .162 75.834);--color-yellow-700:oklch(55.4% .135 66.442);--color-green-500:oklch(72.3% .219 149.579);--color-green-600:oklch(62.7% .194 149.214);--color-green-700:oklch(52.7% .154 150.069);--color-blue-600:oklch(54.6% .245 262.881);--color-blue-700:oklch(48.8% .243 264.376);--color-indigo-50:oklch(96.2% .018 272.314);--color-indigo-100:oklch(93% .034 272.788);--color-indigo-400:oklch(67.3% .182 276.935);--color-indigo-500:oklch(58.5% .233 277.117);--color-indigo-600:oklch(51.1% .262 276.966);--color-indigo-700:oklch(45.7% .24 277.023);--color-purple-500:oklch(62.7% .265 303.9);--color-purple-700:oklch(49.6% .265 301.924);--color-gray-50:oklch(98.5% .002 247.839);--color-gray-100:oklch(96.7% .003 264.542);--color-gray-200:oklch(92.8% .006 264.531);--color-gray-300:oklch(87.2% .01 258.338);--color-gray-400:oklch(70.7% .022 261.325);--color-gray-500:oklch(55.1% .027 264.364);--color-gray-600:oklch(44.6% .03 256.802);--color-gray-700:oklch(37.3% .034 259.733);--color-gray-800:oklch(27.8% .033 256.848);--color-gray-900:oklch(21% .034 264.665);--color-black:#000;--color-white:#fff;--spacing:.25rem;--container-md:28rem;--container-xl:36rem;--container-2xl:42rem;--container-3xl:48rem;--container-4xl:56rem;--container-6xl:72rem;--container-7xl:80rem;--text-xs:.75rem;--text-xs--line-height:calc(1/.75);--text-sm:.875rem;--text-sm--line-height:calc(1.25/.875);--text-base:1rem;--text-base--line-height: 1.5 ;--text-lg:1.125rem;--text-lg--line-height:calc(1.75/1.125);--text-xl:1.25rem;--text-xl--line-height:calc(1.75/1.25);--text-2xl:1.5rem;--text-2xl--line-height:calc(2/1.5);--text-3xl:1.875rem;--text-3xl--line-height: 1.2 ;--text-4xl:2.25rem;--text-4xl--line-height:calc(2.5/2.25);--text-5xl:3rem;--text-5xl--line-height:1;--font-weight-medium:500;--font-weight-semibold:600;--font-weight-bold:700;--font-weight-extrabold:800;--tracking-tight:-.025em;--leading-tight:1.25;--radius-md:.375rem;--radius-lg:.5rem;--radius-xl:.75rem;--radius-2xl:1rem;--ease-in-out:cubic-bezier(.4,0,.2,1);--animate-spin:spin 1s linear infinite;--blur-sm:8px;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--default-mono-font-family:var(--font-mono)}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1}@supports (not ((-webkit-appearance:-apple-pay-button))) or (contain-intrinsic-size:1px){::placeholder{color:currentColor}@supports (color:color-mix(in lab,red,red)){::placeholder{color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.visible{visibility:visible}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}.static{position:static}.sticky{position:sticky}.inset-0{inset:calc(var(--spacing)*0)}.top-0{top:calc(var(--spacing)*0)}.top-1{top:calc(var(--spacing)*1)}.top-1\\/2{top:50%}.top-2{top:calc(var(--spacing)*2)}.right-0{right:calc(var(--spacing)*0)}.right-2{right:calc(var(--spacing)*2)}.right-6{right:calc(var(--spacing)*6)}.right-20{right:calc(var(--spacing)*20)}.bottom-3{bottom:calc(var(--spacing)*3)}.bottom-6{bottom:calc(var(--spacing)*6)}.z-10{z-index:10}.z-40{z-index:40}.z-50{z-index:50}.container{width:100%}@media (min-width:40rem){.container{max-width:40rem}}@media (min-width:48rem){.container{max-width:48rem}}@media (min-width:64rem){.container{max-width:64rem}}@media (min-width:80rem){.container{max-width:80rem}}@media (min-width:96rem){.container{max-width:96rem}}.m-4{margin:calc(var(--spacing)*4)}.mx-auto{margin-inline:auto}.mt-1{margin-top:calc(var(--spacing)*1)}.mt-2{margin-top:calc(var(--spacing)*2)}.mt-4{margin-top:calc(var(--spacing)*4)}.mt-6{margin-top:calc(var(--spacing)*6)}.mt-8{margin-top:calc(var(--spacing)*8)}.mr-2{margin-right:calc(var(--spacing)*2)}.mb-1{margin-bottom:calc(var(--spacing)*1)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.mb-4{margin-bottom:calc(var(--spacing)*4)}.mb-6{margin-bottom:calc(var(--spacing)*6)}.mb-8{margin-bottom:calc(var(--spacing)*8)}.mb-10{margin-bottom:calc(var(--spacing)*10)}.mb-12{margin-bottom:calc(var(--spacing)*12)}.mb-16{margin-bottom:calc(var(--spacing)*16)}.ml-1{margin-left:calc(var(--spacing)*1)}.block{display:block}.contents{display:contents}.flex{display:flex}.grid{display:grid}.hidden{display:none}.inline{display:inline}.inline-block{display:inline-block}.inline-flex{display:inline-flex}.table{display:table}.size-6{width:calc(var(--spacing)*6);height:calc(var(--spacing)*6)}.h-4{height:calc(var(--spacing)*4)}.h-5{height:calc(var(--spacing)*5)}.h-6{height:calc(var(--spacing)*6)}.h-8{height:calc(var(--spacing)*8)}.h-10{height:calc(var(--spacing)*10)}.h-16{height:calc(var(--spacing)*16)}.h-\\[10rem\\]{height:10rem}.h-\\[40vh\\]{height:40vh}.h-\\[84vh\\]{height:84vh}.h-auto{height:auto}.h-full{height:100%}.h-screen{height:100vh}.max-h-\\[300px\\]{max-height:300px}.max-h-full{max-height:100%}.min-h-\\[60px\\]{min-height:60px}.w-4{width:calc(var(--spacing)*4)}.w-5{width:calc(var(--spacing)*5)}.w-6{width:calc(var(--spacing)*6)}.w-10{width:calc(var(--spacing)*10)}.w-14{width:calc(var(--spacing)*14)}.w-24{width:calc(var(--spacing)*24)}.w-\\[10rem\\]{width:10rem}.w-\\[48\\%\\]{width:48%}.w-\\[92vw\\]{width:92vw}.w-\\[260px\\]{width:260px}.w-auto{width:auto}.w-full{width:100%}.w-screen{width:100vw}.max-w-1{max-width:calc(var(--spacing)*1)}.max-w-1\\/4{max-width:25%}.max-w-2xl{max-width:var(--container-2xl)}.max-w-3xl{max-width:var(--container-3xl)}.max-w-4xl{max-width:var(--container-4xl)}.max-w-6xl{max-width:var(--container-6xl)}.max-w-7xl{max-width:var(--container-7xl)}.max-w-\\[780px\\]{max-width:780px}.max-w-full{max-width:100%}.max-w-md{max-width:var(--container-md)}.max-w-xl{max-width:var(--container-xl)}.flex-1{flex:1}.translate-x-0{--tw-translate-x:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.translate-x-6{--tw-translate-x:calc(var(--spacing)*6);translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-1{--tw-translate-y:calc(var(--spacing)*-1);translate:var(--tw-translate-x)var(--tw-translate-y)}.-translate-y-1\\/2{--tw-translate-y: -50% ;translate:var(--tw-translate-x)var(--tw-translate-y)}.scale-95{--tw-scale-x:95%;--tw-scale-y:95%;--tw-scale-z:95%;scale:var(--tw-scale-x)var(--tw-scale-y)}.transform{transform:var(--tw-rotate-x,)var(--tw-rotate-y,)var(--tw-rotate-z,)var(--tw-skew-x,)var(--tw-skew-y,)}.animate-spin{animation:var(--animate-spin)}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.cursor-zoom-in{cursor:zoom-in}.cursor-zoom-out{cursor:zoom-out}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-row{flex-direction:row}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.justify-start{justify-content:flex-start}.gap-1{gap:calc(var(--spacing)*1)}.gap-2{gap:calc(var(--spacing)*2)}.gap-3{gap:calc(var(--spacing)*3)}.gap-4{gap:calc(var(--spacing)*4)}.gap-8{gap:calc(var(--spacing)*8)}:where(.space-y-1>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*1)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*1)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-2>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*2)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*2)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-4>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*4)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*4)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-6>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*6)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*6)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-y-8>:not(:last-child)){--tw-space-y-reverse:0;margin-block-start:calc(calc(var(--spacing)*8)*var(--tw-space-y-reverse));margin-block-end:calc(calc(var(--spacing)*8)*calc(1 - var(--tw-space-y-reverse)))}:where(.space-x-4>:not(:last-child)){--tw-space-x-reverse:0;margin-inline-start:calc(calc(var(--spacing)*4)*var(--tw-space-x-reverse));margin-inline-end:calc(calc(var(--spacing)*4)*calc(1 - var(--tw-space-x-reverse)))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:var(--radius-2xl)}.rounded-full{border-radius:3.40282e38px}.rounded-lg{border-radius:var(--radius-lg)}.rounded-md{border-radius:var(--radius-md)}.rounded-xl{border-radius:var(--radius-xl)}.rounded-t-2xl{border-top-left-radius:var(--radius-2xl);border-top-right-radius:var(--radius-2xl)}.rounded-l-xl{border-top-left-radius:var(--radius-xl);border-bottom-left-radius:var(--radius-xl)}.border{border-style:var(--tw-border-style);border-width:1px}.border-t{border-top-style:var(--tw-border-style);border-top-width:1px}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-b-2{border-bottom-style:var(--tw-border-style);border-bottom-width:2px}.border-blue-700{border-color:var(--color-blue-700)}.border-gray-100{border-color:var(--color-gray-100)}.border-gray-200{border-color:var(--color-gray-200)}.border-gray-300{border-color:var(--color-gray-300)}.border-indigo-500{border-color:var(--color-indigo-500)}.border-indigo-600{border-color:var(--color-indigo-600)}.border-red-500{border-color:var(--color-red-500)}.border-transparent{border-color:#0000}.border-white{border-color:var(--color-white)}.border-white\\/20{border-color:#fff3}@supports (color:color-mix(in lab,red,red)){.border-white\\/20{border-color:color-mix(in oklab,var(--color-white)20%,transparent)}}.bg-black{background-color:var(--color-black)}.bg-black\\/40{background-color:#0006}@supports (color:color-mix(in lab,red,red)){.bg-black\\/40{background-color:color-mix(in oklab,var(--color-black)40%,transparent)}}.bg-black\\/60{background-color:#0009}@supports (color:color-mix(in lab,red,red)){.bg-black\\/60{background-color:color-mix(in oklab,var(--color-black)60%,transparent)}}.bg-black\\/90{background-color:#000000e6}@supports (color:color-mix(in lab,red,red)){.bg-black\\/90{background-color:color-mix(in oklab,var(--color-black)90%,transparent)}}.bg-blue-600{background-color:var(--color-blue-600)}.bg-gray-50{background-color:var(--color-gray-50)}.bg-gray-100{background-color:var(--color-gray-100)}.bg-gray-200{background-color:var(--color-gray-200)}.bg-gray-300{background-color:var(--color-gray-300)}.bg-gray-900{background-color:var(--color-gray-900)}.bg-green-500{background-color:var(--color-green-500)}.bg-green-600{background-color:var(--color-green-600)}.bg-indigo-50{background-color:var(--color-indigo-50)}.bg-indigo-100{background-color:var(--color-indigo-100)}.bg-indigo-600{background-color:var(--color-indigo-600)}.bg-red-500{background-color:var(--color-red-500)}.bg-red-600{background-color:var(--color-red-600)}.bg-white{background-color:var(--color-white)}.bg-yellow-500{background-color:var(--color-yellow-500)}.bg-yellow-600{background-color:var(--color-yellow-600)}.bg-gradient-to-br{--tw-gradient-position:to bottom right in oklab;background-image:linear-gradient(var(--tw-gradient-stops))}.bg-gradient-to-r{--tw-gradient-position:to right in oklab;background-image:linear-gradient(var(--tw-gradient-stops))}.from-indigo-600{--tw-gradient-from:var(--color-indigo-600);--tw-gradient-stops:var(--tw-gradient-via-stops,var(--tw-gradient-position),var(--tw-gradient-from)var(--tw-gradient-from-position),var(--tw-gradient-to)var(--tw-gradient-to-position))}.from-indigo-700{--tw-gradient-from:var(--color-indigo-700);--tw-gradient-stops:var(--tw-gradient-via-stops,var(--tw-gradient-position),var(--tw-gradient-from)var(--tw-gradient-from-position),var(--tw-gradient-to)var(--tw-gradient-to-position))}.to-purple-500{--tw-gradient-to:var(--color-purple-500);--tw-gradient-stops:var(--tw-gradient-via-stops,var(--tw-gradient-position),var(--tw-gradient-from)var(--tw-gradient-from-position),var(--tw-gradient-to)var(--tw-gradient-to-position))}.to-purple-700{--tw-gradient-to:var(--color-purple-700);--tw-gradient-stops:var(--tw-gradient-via-stops,var(--tw-gradient-position),var(--tw-gradient-from)var(--tw-gradient-from-position),var(--tw-gradient-to)var(--tw-gradient-to-position))}.object-cover{object-fit:cover}.p-2{padding:calc(var(--spacing)*2)}.p-3{padding:calc(var(--spacing)*3)}.p-4{padding:calc(var(--spacing)*4)}.p-6{padding:calc(var(--spacing)*6)}.p-10{padding:calc(var(--spacing)*10)}.px-1{padding-inline:calc(var(--spacing)*1)}.px-2{padding-inline:calc(var(--spacing)*2)}.px-3{padding-inline:calc(var(--spacing)*3)}.px-4{padding-inline:calc(var(--spacing)*4)}.px-5{padding-inline:calc(var(--spacing)*5)}.px-6{padding-inline:calc(var(--spacing)*6)}.px-8{padding-inline:calc(var(--spacing)*8)}.py-1{padding-block:calc(var(--spacing)*1)}.py-2{padding-block:calc(var(--spacing)*2)}.py-3{padding-block:calc(var(--spacing)*3)}.py-4{padding-block:calc(var(--spacing)*4)}.py-5{padding-block:calc(var(--spacing)*5)}.py-6{padding-block:calc(var(--spacing)*6)}.py-10{padding-block:calc(var(--spacing)*10)}.py-16{padding-block:calc(var(--spacing)*16)}.py-24{padding-block:calc(var(--spacing)*24)}.pr-32{padding-right:calc(var(--spacing)*32)}.pl-6{padding-left:calc(var(--spacing)*6)}.text-center{text-align:center}.text-left{text-align:left}.font-sans{font-family:var(--font-sans)}.text-2xl{font-size:var(--text-2xl);line-height:var(--tw-leading,var(--text-2xl--line-height))}.text-3xl{font-size:var(--text-3xl);line-height:var(--tw-leading,var(--text-3xl--line-height))}.text-4xl{font-size:var(--text-4xl);line-height:var(--tw-leading,var(--text-4xl--line-height))}.text-5xl{font-size:var(--text-5xl);line-height:var(--tw-leading,var(--text-5xl--line-height))}.text-base{font-size:var(--text-base);line-height:var(--tw-leading,var(--text-base--line-height))}.text-lg{font-size:var(--text-lg);line-height:var(--tw-leading,var(--text-lg--line-height))}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-xl{font-size:var(--text-xl);line-height:var(--tw-leading,var(--text-xl--line-height))}.text-xs{font-size:var(--text-xs);line-height:var(--tw-leading,var(--text-xs--line-height))}.leading-tight{--tw-leading:var(--leading-tight);line-height:var(--leading-tight)}.font-bold{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}.font-extrabold{--tw-font-weight:var(--font-weight-extrabold);font-weight:var(--font-weight-extrabold)}.font-medium{--tw-font-weight:var(--font-weight-medium);font-weight:var(--font-weight-medium)}.font-semibold{--tw-font-weight:var(--font-weight-semibold);font-weight:var(--font-weight-semibold)}.tracking-tight{--tw-tracking:var(--tracking-tight);letter-spacing:var(--tracking-tight)}.text-blue-600{color:var(--color-blue-600)}.text-gray-200{color:var(--color-gray-200)}.text-gray-400{color:var(--color-gray-400)}.text-gray-500{color:var(--color-gray-500)}.text-gray-600{color:var(--color-gray-600)}.text-gray-700{color:var(--color-gray-700)}.text-gray-800{color:var(--color-gray-800)}.text-gray-900{color:var(--color-gray-900)}.text-green-600{color:var(--color-green-600)}.text-green-700{color:var(--color-green-700)}.text-indigo-600{color:var(--color-indigo-600)}.text-indigo-700{color:var(--color-indigo-700)}.text-red-500{color:var(--color-red-500)}.text-red-600{color:var(--color-red-600)}.text-white{color:var(--color-white)}.text-yellow-700{color:var(--color-yellow-700)}.underline{text-decoration-line:underline}.opacity-25{opacity:.25}.opacity-75{opacity:.75}.opacity-80{opacity:.8}.opacity-90{opacity:.9}.shadow{--tw-shadow:0 1px 3px 0 var(--tw-shadow-color,#0000001a),0 1px 2px -1px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-2xl{--tw-shadow:0 25px 50px -12px var(--tw-shadow-color,#00000040);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px var(--tw-shadow-color,#0000001a),0 4px 6px -4px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px var(--tw-shadow-color,#0000001a),0 2px 4px -2px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 3px 0 var(--tw-shadow-color,#0000001a),0 1px 2px -1px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px var(--tw-shadow-color,#0000001a),0 8px 10px -6px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.ring-2{--tw-ring-shadow:var(--tw-ring-inset,)0 0 0 calc(2px + var(--tw-ring-offset-width))var(--tw-ring-color,currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.ring-indigo-400{--tw-ring-color:var(--color-indigo-400)}.backdrop-blur-sm{--tw-backdrop-blur:blur(var(--blur-sm));-webkit-backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,)var(--tw-backdrop-brightness,)var(--tw-backdrop-contrast,)var(--tw-backdrop-grayscale,)var(--tw-backdrop-hue-rotate,)var(--tw-backdrop-invert,)var(--tw-backdrop-opacity,)var(--tw-backdrop-saturate,)var(--tw-backdrop-sepia,)}.transition{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to,opacity,box-shadow,transform,translate,scale,rotate,filter,-webkit-backdrop-filter,backdrop-filter,display,visibility,content-visibility,overlay,pointer-events;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-all{transition-property:all;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-colors{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-opacity{transition-property:opacity;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-shadow{transition-property:box-shadow;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-transform{transition-property:transform,translate,scale,rotate;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.duration-200{--tw-duration:.2s;transition-duration:.2s}.duration-300{--tw-duration:.3s;transition-duration:.3s}.duration-\\[1500ms\\]{--tw-duration:1.5s;transition-duration:1.5s}.ease-in-out{--tw-ease:var(--ease-in-out);transition-timing-function:var(--ease-in-out)}.outline-none{--tw-outline-style:none;outline-style:none}.select-none{-webkit-user-select:none;user-select:none}@media (hover:hover){.group-hover\\:text-inherit:is(:where(.group):hover *){color:inherit}.hover\\:scale-105:hover{--tw-scale-x:105%;--tw-scale-y:105%;--tw-scale-z:105%;scale:var(--tw-scale-x)var(--tw-scale-y)}.hover\\:bg-blue-700:hover{background-color:var(--color-blue-700)}.hover\\:bg-gray-50:hover{background-color:var(--color-gray-50)}.hover\\:bg-gray-100:hover{background-color:var(--color-gray-100)}.hover\\:bg-gray-200:hover{background-color:var(--color-gray-200)}.hover\\:bg-gray-300:hover{background-color:var(--color-gray-300)}.hover\\:bg-green-700:hover{background-color:var(--color-green-700)}.hover\\:bg-indigo-100:hover{background-color:var(--color-indigo-100)}.hover\\:bg-indigo-700:hover{background-color:var(--color-indigo-700)}.hover\\:bg-red-100:hover{background-color:var(--color-red-100)}.hover\\:bg-red-600:hover{background-color:var(--color-red-600)}.hover\\:bg-red-700:hover{background-color:var(--color-red-700)}.hover\\:bg-yellow-600:hover{background-color:var(--color-yellow-600)}.hover\\:bg-yellow-700:hover{background-color:var(--color-yellow-700)}.hover\\:text-indigo-500:hover{color:var(--color-indigo-500)}.hover\\:text-indigo-600:hover{color:var(--color-indigo-600)}.hover\\:underline:hover{text-decoration-line:underline}.hover\\:shadow-lg:hover{--tw-shadow:0 10px 15px -3px var(--tw-shadow-color,#0000001a),0 4px 6px -4px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.hover\\:shadow-md:hover{--tw-shadow:0 4px 6px -1px var(--tw-shadow-color,#0000001a),0 2px 4px -2px var(--tw-shadow-color,#0000001a);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}}.focus\\:border-indigo-500:focus{border-color:var(--color-indigo-500)}.focus\\:ring-2:focus{--tw-ring-shadow:var(--tw-ring-inset,)0 0 0 calc(2px + var(--tw-ring-offset-width))var(--tw-ring-color,currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.focus\\:ring-indigo-500:focus{--tw-ring-color:var(--color-indigo-500)}.focus\\:outline-none:focus{--tw-outline-style:none;outline-style:none}.disabled\\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\\:opacity-50:disabled{opacity:.5}.disabled\\:opacity-60:disabled{opacity:.6}@media (min-width:40rem){.sm\\:mb-0{margin-bottom:calc(var(--spacing)*0)}.sm\\:w-\\[400px\\]{width:400px}.sm\\:w-auto{width:auto}.sm\\:flex-row{flex-direction:row}.sm\\:flex-nowrap{flex-wrap:nowrap}.sm\\:justify-end{justify-content:flex-end}.sm\\:gap-3{gap:calc(var(--spacing)*3)}.sm\\:gap-4{gap:calc(var(--spacing)*4)}.sm\\:px-8{padding-inline:calc(var(--spacing)*8)}.sm\\:text-left{text-align:left}}@media (min-width:48rem){.md\\:block{display:block}.md\\:hidden{display:none}.md\\:w-64{width:calc(var(--spacing)*64)}.md\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\\:flex-row{flex-direction:row}.md\\:p-0{padding:calc(var(--spacing)*0)}.md\\:p-8{padding:calc(var(--spacing)*8)}.md\\:text-5xl{font-size:var(--text-5xl);line-height:var(--tw-leading,var(--text-5xl--line-height))}.md\\:text-xl{font-size:var(--text-xl);line-height:var(--tw-leading,var(--text-xl--line-height))}}@media (min-width:64rem){.lg\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.lg\\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}}@media (prefers-color-scheme:dark){.dark\\:border-gray-600{border-color:var(--color-gray-600)}.dark\\:border-gray-700{border-color:var(--color-gray-700)}.dark\\:bg-gray-700{background-color:var(--color-gray-700)}.dark\\:bg-gray-800{background-color:var(--color-gray-800)}.dark\\:bg-gray-900{background-color:var(--color-gray-900)}.dark\\:text-gray-200{color:var(--color-gray-200)}.dark\\:text-gray-300{color:var(--color-gray-300)}.dark\\:text-gray-400{color:var(--color-gray-400)}.dark\\:text-white{color:var(--color-white)}@media (hover:hover){.dark\\:hover\\:bg-gray-700:hover{background-color:var(--color-gray-700)}.dark\\:hover\\:bg-red-900:hover{background-color:var(--color-red-900)}}}}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-scale-x{syntax:"*";inherits:false;initial-value:1}@property --tw-scale-y{syntax:"*";inherits:false;initial-value:1}@property --tw-scale-z{syntax:"*";inherits:false;initial-value:1}@property --tw-rotate-x{syntax:"*";inherits:false}@property --tw-rotate-y{syntax:"*";inherits:false}@property --tw-rotate-z{syntax:"*";inherits:false}@property --tw-skew-x{syntax:"*";inherits:false}@property --tw-skew-y{syntax:"*";inherits:false}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-space-x-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-gradient-position{syntax:"*";inherits:false}@property --tw-gradient-from{syntax:"<color>";inherits:false;initial-value:#0000}@property --tw-gradient-via{syntax:"<color>";inherits:false;initial-value:#0000}@property --tw-gradient-to{syntax:"<color>";inherits:false;initial-value:#0000}@property --tw-gradient-stops{syntax:"*";inherits:false}@property --tw-gradient-via-stops{syntax:"*";inherits:false}@property --tw-gradient-from-position{syntax:"<length-percentage>";inherits:false;initial-value:0%}@property --tw-gradient-via-position{syntax:"<length-percentage>";inherits:false;initial-value:50%}@property --tw-gradient-to-position{syntax:"<length-percentage>";inherits:false;initial-value:100%}@property --tw-leading{syntax:"*";inherits:false}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-tracking{syntax:"*";inherits:false}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-backdrop-blur{syntax:"*";inherits:false}@property --tw-backdrop-brightness{syntax:"*";inherits:false}@property --tw-backdrop-contrast{syntax:"*";inherits:false}@property --tw-backdrop-grayscale{syntax:"*";inherits:false}@property --tw-backdrop-hue-rotate{syntax:"*";inherits:false}@property --tw-backdrop-invert{syntax:"*";inherits:false}@property --tw-backdrop-opacity{syntax:"*";inherits:false}@property --tw-backdrop-saturate{syntax:"*";inherits:false}@property --tw-backdrop-sepia{syntax:"*";inherits:false}@property --tw-duration{syntax:"*";inherits:false}@property --tw-ease{syntax:"*";inherits:false}@keyframes spin{to{transform:rotate(360deg)}}')),document.head.appendChild(r)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
var To=xe=>{throw TypeError(xe)};var Xe=(xe,Oe,Et)=>Oe.has(xe)?To("Cannot add the same private member more than once"):Oe instanceof WeakSet?Oe.add(xe):Oe.set(xe,Et);/*! Talkizi Widget v6.3.5 – 2025-08-30T04:09:13.416Z */(function(){"use strict";var an,cn,ln,un;function xe(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}const Oe=!1,Et=(n,e)=>n===e,Qr=Symbol("solid-track"),Ze={equals:Et};let dn=mn;const Ce=1,et=2,fn={owned:null,cleanups:null,context:null,owner:null};var A=null;let wt=null,Xr=null,j=null,W=null,ve=null,tt=0;function nt(n,e){const t=j,r=A,i=n.length===0,s=e===void 0?r:e,o=i?fn:{owned:null,cleanups:null,context:s?s.context:null,owner:s},a=i?n:()=>n(()=>le(()=>Ue(o)));A=o,j=null;try{return ze(a,!0)}finally{j=t,A=r}}function O(n,e){e=e?Object.assign({},Ze,e):Ze;const t={value:n,observers:null,observerSlots:null,comparator:e.equals||void 0},r=i=>(typeof i=="function"&&(i=i(t.value)),pn(t,i));return[hn.bind(t),r]}function te(n,e,t){const r=At(n,e,!1,Ce);je(r)}function rt(n,e,t){dn=si;const r=At(n,e,!1,Ce);r.user=!0,ve?ve.push(r):je(r)}function Te(n,e,t){t=t?Object.assign({},Ze,t):Ze;const r=At(n,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=t.equals||void 0,je(r),hn.bind(r)}function le(n){if(j===null)return n();const e=j;j=null;try{return n()}finally{j=e}}function Zr(n){rt(()=>le(n))}function Pt(n){return A===null||(A.cleanups===null?A.cleanups=[n]:A.cleanups.push(n)),n}function ei(n,e){const t=Symbol("context");return{id:t,Provider:ai(t),defaultValue:n}}function ti(n){let e;return A&&A.context&&(e=A.context[n.id])!==void 0?e:n.defaultValue}function ni(n){const e=Te(n),t=Te(()=>Ot(e()));return t.toArray=()=>{const r=t();return Array.isArray(r)?r:r!=null?[r]:[]},t}function hn(){if(this.sources&&this.state)if(this.state===Ce)je(this);else{const n=W;W=null,ze(()=>st(this),!1),W=n}if(j){const n=this.observers?this.observers.length:0;j.sources?(j.sources.push(this),j.sourceSlots.push(n)):(j.sources=[this],j.sourceSlots=[n]),this.observers?(this.observers.push(j),this.observerSlots.push(j.sources.length-1)):(this.observers=[j],this.observerSlots=[j.sources.length-1])}return this.value}function pn(n,e,t){let r=n.value;return(!n.comparator||!n.comparator(r,e))&&(n.value=e,n.observers&&n.observers.length&&ze(()=>{for(let i=0;i<n.observers.length;i+=1){const s=n.observers[i],o=wt&&wt.running;o&&wt.disposed.has(s),(o?!s.tState:!s.state)&&(s.pure?W.push(s):ve.push(s),s.observers&&gn(s)),o||(s.state=Ce)}if(W.length>1e6)throw W=[],new Error},!1)),e}function je(n){if(!n.fn)return;Ue(n);const e=tt;ri(n,n.value,e)}function ri(n,e,t){let r;const i=A,s=j;j=A=n;try{r=n.fn(e)}catch(o){return n.pure&&(n.state=Ce,n.owned&&n.owned.forEach(Ue),n.owned=null),n.updatedAt=t+1,yn(o)}finally{j=s,A=i}(!n.updatedAt||n.updatedAt<=t)&&(n.updatedAt!=null&&"observers"in n?pn(n,r):n.value=r,n.updatedAt=t)}function At(n,e,t,r=Ce,i){const s={fn:n,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:A,context:A?A.context:null,pure:t};return A===null||A!==fn&&(A.owned?A.owned.push(s):A.owned=[s]),s}function it(n){if(n.state===0)return;if(n.state===et)return st(n);if(n.suspense&&le(n.suspense.inFallback))return n.suspense.effects.push(n);const e=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<tt);)n.state&&e.push(n);for(let t=e.length-1;t>=0;t--)if(n=e[t],n.state===Ce)je(n);else if(n.state===et){const r=W;W=null,ze(()=>st(n,e[0]),!1),W=r}}function ze(n,e){if(W)return n();let t=!1;e||(W=[]),ve?t=!0:ve=[],tt++;try{const r=n();return ii(t),r}catch(r){t||(ve=null),W=null,yn(r)}}function ii(n){if(W&&(mn(W),W=null),n)return;const e=ve;ve=null,e.length&&ze(()=>dn(e),!1)}function mn(n){for(let e=0;e<n.length;e++)it(n[e])}function si(n){let e,t=0;for(e=0;e<n.length;e++){const r=n[e];r.user?n[t++]=r:it(r)}for(e=0;e<t;e++)it(n[e])}function st(n,e){n.state=0;for(let t=0;t<n.sources.length;t+=1){const r=n.sources[t];if(r.sources){const i=r.state;i===Ce?r!==e&&(!r.updatedAt||r.updatedAt<tt)&&it(r):i===et&&st(r,e)}}}function gn(n){for(let e=0;e<n.observers.length;e+=1){const t=n.observers[e];t.state||(t.state=et,t.pure?W.push(t):ve.push(t),t.observers&&gn(t))}}function Ue(n){let e;if(n.sources)for(;n.sources.length;){const t=n.sources.pop(),r=n.sourceSlots.pop(),i=t.observers;if(i&&i.length){const s=i.pop(),o=t.observerSlots.pop();r<i.length&&(s.sourceSlots[o]=r,i[r]=s,t.observerSlots[r]=o)}}if(n.tOwned){for(e=n.tOwned.length-1;e>=0;e--)Ue(n.tOwned[e]);delete n.tOwned}if(n.owned){for(e=n.owned.length-1;e>=0;e--)Ue(n.owned[e]);n.owned=null}if(n.cleanups){for(e=n.cleanups.length-1;e>=0;e--)n.cleanups[e]();n.cleanups=null}n.state=0}function oi(n){return n instanceof Error?n:new Error(typeof n=="string"?n:"Unknown error",{cause:n})}function yn(n,e=A){throw oi(n)}function Ot(n){if(typeof n=="function"&&!n.length)return Ot(n());if(Array.isArray(n)){const e=[];for(let t=0;t<n.length;t++){const r=Ot(n[t]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return e}return n}function ai(n,e){return function(r){let i;return te(()=>i=le(()=>(A.context={...A.context,[n]:r.value},ni(()=>r.children))),void 0),i}}const ci=Symbol("fallback");function vn(n){for(let e=0;e<n.length;e++)n[e]()}function li(n,e,t={}){let r=[],i=[],s=[],o=0,a=e.length>1?[]:null;return Pt(()=>vn(s)),()=>{let c=n()||[],l=c.length,d,u;return c[Qr],le(()=>{let m,E,C,fe,he,H,ee,I,pe;if(l===0)o!==0&&(vn(s),s=[],r=[],i=[],o=0,a&&(a=[])),t.fallback&&(r=[ci],i[0]=nt(S=>(s[0]=S,t.fallback())),o=1);else if(o===0){for(i=new Array(l),u=0;u<l;u++)r[u]=c[u],i[u]=nt(f);o=l}else{for(C=new Array(l),fe=new Array(l),a&&(he=new Array(l)),H=0,ee=Math.min(o,l);H<ee&&r[H]===c[H];H++);for(ee=o-1,I=l-1;ee>=H&&I>=H&&r[ee]===c[I];ee--,I--)C[I]=i[ee],fe[I]=s[ee],a&&(he[I]=a[ee]);for(m=new Map,E=new Array(I+1),u=I;u>=H;u--)pe=c[u],d=m.get(pe),E[u]=d===void 0?-1:d,m.set(pe,u);for(d=H;d<=ee;d++)pe=r[d],u=m.get(pe),u!==void 0&&u!==-1?(C[u]=i[d],fe[u]=s[d],a&&(he[u]=a[d]),u=E[u],m.set(pe,u)):s[d]();for(u=H;u<l;u++)u in C?(i[u]=C[u],s[u]=fe[u],a&&(a[u]=he[u],a[u](u))):i[u]=nt(f);i=i.slice(0,o=l),r=c.slice(0)}return i});function f(m){if(s[u]=m,a){const[E,C]=O(u);return a[u]=C,e(c[u],E)}return e(c[u])}}}function L(n,e){return le(()=>n(e||{}))}const ui=n=>`Stale read from <${n}>.`;function ot(n){const e="fallback"in n&&{fallback:()=>n.fallback};return Te(li(()=>n.each,n.children,e||void 0))}function Le(n){const e=n.keyed,t=Te(()=>n.when,void 0,void 0),r=e?t:Te(t,void 0,{equals:(i,s)=>!i==!s});return Te(()=>{const i=r();if(i){const s=n.children;return typeof s=="function"&&s.length>0?le(()=>s(e?i:()=>{if(!le(r))throw ui("Show");return t()})):s}return n.fallback},void 0,void 0)}const q=n=>Te(()=>n());function di(n,e,t){let r=t.length,i=e.length,s=r,o=0,a=0,c=e[i-1].nextSibling,l=null;for(;o<i||a<s;){if(e[o]===t[a]){o++,a++;continue}for(;e[i-1]===t[s-1];)i--,s--;if(i===o){const d=s<r?a?t[a-1].nextSibling:t[s-a]:c;for(;a<s;)n.insertBefore(t[a++],d)}else if(s===a)for(;o<i;)(!l||!l.has(e[o]))&&e[o].remove(),o++;else if(e[o]===t[s-1]&&t[a]===e[i-1]){const d=e[--i].nextSibling;n.insertBefore(t[a++],e[o++].nextSibling),n.insertBefore(t[--s],d),e[i]=t[s]}else{if(!l){l=new Map;let u=a;for(;u<s;)l.set(t[u],u++)}const d=l.get(e[o]);if(d!=null)if(a<d&&d<s){let u=o,f=1,m;for(;++u<i&&u<s&&!((m=l.get(e[u]))==null||m!==d+f);)f++;if(f>d-a){const E=e[o];for(;a<d;)n.insertBefore(t[a++],E)}else n.replaceChild(t[a++],e[o++])}else o++;else e[o++].remove()}}}const _n="_$DX_DELEGATE";function bn(n,e,t,r={}){let i;return nt(s=>{i=s,e===document?n():_(e,n(),e.firstChild?null:void 0,t)},r.owner),()=>{i(),e.textContent=""}}function w(n,e,t,r){let i;const s=()=>{const a=r?document.createElementNS("http://www.w3.org/1998/Math/MathML","template"):document.createElement("template");return a.innerHTML=n,t?a.content.firstChild.firstChild:r?a.firstChild:a.content.firstChild},o=e?()=>le(()=>document.importNode(i||(i=s()),!0)):()=>(i||(i=s())).cloneNode(!0);return o.cloneNode=o,o}function Ie(n,e=window.document){const t=e[_n]||(e[_n]=new Set);for(let r=0,i=n.length;r<i;r++){const s=n[r];t.has(s)||(t.add(s),e.addEventListener(s,hi))}}function fi(n,e,t){t==null?n.removeAttribute(e):n.setAttribute(e,t)}function Z(n,e){e==null?n.removeAttribute("class"):n.className=e}function ae(n,e,t,r){Array.isArray(t)?(n[`$$${e}`]=t[0],n[`$$${e}Data`]=t[1]):n[`$$${e}`]=t}function Fe(n,e,t){return le(()=>n(e,t))}function _(n,e,t,r){if(t!==void 0&&!r&&(r=[]),typeof e!="function")return at(n,e,r,t);te(i=>at(n,e(),i,t),r)}function hi(n){let e=n.target;const t=`$$${n.type}`,r=n.target,i=n.currentTarget,s=c=>Object.defineProperty(n,"target",{configurable:!0,value:c}),o=()=>{const c=e[t];if(c&&!e.disabled){const l=e[`${t}Data`];if(l!==void 0?c.call(e,l,n):c.call(e,n),n.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(n.target)&&s(e.host),!0},a=()=>{for(;o()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}}),n.composedPath){const c=n.composedPath();s(c[0]);for(let l=0;l<c.length-2&&(e=c[l],!!o());l++){if(e._$host){e=e._$host,a();break}if(e.parentNode===i)break}}else a();s(r)}function at(n,e,t,r,i){for(;typeof t=="function";)t=t();if(e===t)return t;const s=typeof e,o=r!==void 0;if(n=o&&t[0]&&t[0].parentNode||n,s==="string"||s==="number"){if(s==="number"&&(e=e.toString(),e===t))return t;if(o){let a=t[0];a&&a.nodeType===3?a.data!==e&&(a.data=e):a=document.createTextNode(e),t=De(n,t,r,a)}else t!==""&&typeof t=="string"?t=n.firstChild.data=e:t=n.textContent=e}else if(e==null||s==="boolean")t=De(n,t,r);else{if(s==="function")return te(()=>{let a=e();for(;typeof a=="function";)a=a();t=at(n,a,t,r)}),()=>t;if(Array.isArray(e)){const a=[],c=t&&Array.isArray(t);if(Lt(a,e,t,i))return te(()=>t=at(n,a,t,r,!0)),()=>t;if(a.length===0){if(t=De(n,t,r),o)return t}else c?t.length===0?Cn(n,a,r):di(n,t,a):(t&&De(n),Cn(n,a));t=a}else if(e.nodeType){if(Array.isArray(t)){if(o)return t=De(n,t,r,e);De(n,t,null,e)}else t==null||t===""||!n.firstChild?n.appendChild(e):n.replaceChild(e,n.firstChild);t=e}}return t}function Lt(n,e,t,r){let i=!1;for(let s=0,o=e.length;s<o;s++){let a=e[s],c=t&&t[n.length],l;if(!(a==null||a===!0||a===!1))if((l=typeof a)=="object"&&a.nodeType)n.push(a);else if(Array.isArray(a))i=Lt(n,a,c)||i;else if(l==="function")if(r){for(;typeof a=="function";)a=a();i=Lt(n,Array.isArray(a)?a:[a],Array.isArray(c)?c:[c])||i}else n.push(a),i=!0;else{const d=String(a);c&&c.nodeType===3&&c.data===d?n.push(c):n.push(document.createTextNode(d))}}return i}function Cn(n,e,t=null){for(let r=0,i=e.length;r<i;r++)n.insertBefore(e[r],t)}function De(n,e,t,r){if(t===void 0)return n.textContent="";const i=r||document.createTextNode("");if(e.length){let s=!1;for(let o=e.length-1;o>=0;o--){const a=e[o];if(i!==a){const c=a.parentNode===n;!s&&!o?c?n.replaceChild(i,a):n.insertBefore(i,t):c&&a.remove()}else s=!0}}else n.insertBefore(i,t);return[i]}var $e=(n=>(n.FREE="free",n.STARTER="starter",n.PRO="pro",n.BUSINESS="business",n.ENTERPRISE="enterprise",n))($e||{});const pi={[$e.FREE]:{label:"Gratuit",price:"0 €",desc:"1 salon vocal, audio uniquement, jusqu’à 4 participants.",maxRooms:1,video:!1,screenShare:!1,participants:4,stats:!1,webhooks:!1,privateAccess:!1,customBranding:!1,dedicatedHosting:!1,prioritySupport:!1},[$e.STARTER]:{label:"Starter",price:"5 €",desc:"1 salon vocal, audio + vidéo + écran, jusqu’à 10 participants.",maxRooms:1,video:!0,screenShare:!0,participants:10,stats:!1,webhooks:!1,privateAccess:!1,customBranding:!1,dedicatedHosting:!1,prioritySupport:!1},[$e.PRO]:{label:"Pro",price:"19 €",desc:"3 salons, audio + vidéo + écran, jusqu’à 10 participants, statistiques simples.",maxRooms:3,video:!0,screenShare:!0,participants:10,stats:!0,webhooks:!1,privateAccess:!1,customBranding:!1,dedicatedHosting:!1,prioritySupport:!1},[$e.BUSINESS]:{label:"Business",price:"49 €",desc:"10 salons privés, accès par token, 20 participants, stats avancées, webhooks, personnalisation.",maxRooms:10,video:!0,screenShare:!0,participants:20,stats:!0,webhooks:!0,privateAccess:!0,customBranding:!0,dedicatedHosting:!1,prioritySupport:!1},[$e.ENTERPRISE]:{label:"Entreprise",price:"Sur devis",desc:"Salons illimités, intégration avancée, hébergement dédié, support prioritaire.",maxRooms:1/0,video:!0,screenShare:!0,participants:1/0,stats:!0,webhooks:!0,privateAccess:!0,customBranding:!0,dedicatedHosting:!0,prioritySupport:!0}};var mi=w('<span class="text-xs text-red-500 mt-1 font-medium">Salle pleine (<!> max)'),gi=w('<button><div class="flex flex-col"><span class="text-sm font-semibold"></span><span class="text-xs text-gray-500 dark:text-gray-400 group-hover:text-inherit"></span></div><div class="flex items-center gap-1 text-xs"><svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke-width=1.5 stroke=currentColor class=size-6><path stroke-linecap=round stroke-linejoin=round d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"></path></svg><span>/');function yi(n){var i;const e=((i=pi[n.plan])==null?void 0:i.participants)??4,t=n.count>=e,r=n.joinedRoomId===n.room._id;return(()=>{var s=gi(),o=s.firstChild,a=o.firstChild,c=a.nextSibling,l=o.nextSibling,d=l.firstChild,u=d.nextSibling,f=u.firstChild;return ae(s,"click",t?void 0:n.onJoin),s.disabled=t,_(a,()=>n.room.name),_(c,()=>n.room.description),_(o,L(Le,{when:t,get children(){var m=mi(),E=m.firstChild,C=E.nextSibling;return C.nextSibling,_(m,e,C),m}}),null),_(u,()=>n==null?void 0:n.count,f),_(u,e,null),te(()=>Z(s,`${n.fullScreen?"w-[10rem] h-[10rem]":"w-full"} text-left p-4 rounded-xl border transition-shadow shadow-sm flex items-center justify-between group ${r?"bg-blue-600 text-white border-blue-700 shadow-md":t?"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-300 border-gray-300 dark:border-gray-600 cursor-not-allowed":"bg-white dark:bg-gray-800 text-gray-800 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700 border-gray-200 dark:border-gray-600"}`)),s})()}Ie(["click"]);const Sn=ei();function vi(n){const e=["fr","en"],t=localStorage.getItem("lang"),r=()=>{const a=navigator.language.slice(0,2);return e.includes(a)?a:"en"},[i,s]=O(t||r()),o=a=>{s(a),localStorage.setItem("lang",a)};return L(Sn.Provider,{value:{lang:i,setLang:o},get children(){return n.children}})}function kn(){const n=ti(Sn);if(!n)throw new Error("useLang must be used within a LangProvider");return n}const xn={fr:{heroTitle:"Ajoutez un salon vocal interactif en un script.",heroSubtitle:"Talkizi transforme instantanément votre site en espace vocal vivant, sans effort.",cta:"Essayez Talkizi gratuitement",why:"Pourquoi Talkizi ?",whyPoints:[{title:"Ultra-léger",desc:"Seulement 10kb, rapide et sans impact.",icon:"⚡️"},{title:"Installation instantanée",desc:"Copiez, collez, parlez.",icon:"🚀"},{title:"Personnalisable",desc:"Adaptez-le à votre marque.",icon:"🎨"},{title:"Boostez l’engagement",desc:"Créez des communautés actives.",icon:"💬"}],love:"Ce qu'ils vont adorer",snippetTitle:"Ajoutez Talkizi en 1 ligne",pricingTitle:"Tarifs",plans:[{title:"Gratuit",price:"0 € /mois",desc:"1 salon vocal, audio uniquement, jusqu’à 4 participants."},{title:"Starter",price:"5 € /mois HT",desc:"1 salon vocal, audio + vidéo + écran, jusqu’à 10 participants."},{title:"Pro",price:"19 € /mois HT",desc:"3 salons, audio + vidéo + écran, jusqu’à 10 participants, statistiques simples."},{title:"Business",price:"49 € /mois HT",desc:"10 salons privés, accès par token, 20 participants, stats avancées, webhooks, personnalisation."},{title:"Entreprise",price:"Sur devis",desc:"Salons illimités, intégration avancée, hébergement dédié, support prioritaire."}],faqTitle:"FAQ",faq:[{q:"Talkizi impacte-t-il les performances ?",a:"Non, il est ultra-léger et optimisé pour un chargement rapide."},{q:"Puis-je personnaliser le widget ?",a:"Oui, la personnalisation est disponible dès le plan Pro."},{q:"Ai-je besoin d’un compte ?",a:"Non, vous pouvez l’intégrer et l’essayer immédiatement, sans création de compte."}],finalCta:"Prêt à parler ? Essayez gratuitement !",legal:{title:"Mentions légales",editor:"Éditeur du site",editorDetails:"Le site Talkizi est édité par :",talkiziInfo:"Talkizi",siret:"SIRET : 83747616700031",email:"Email : contact@talkizi.com",hosting:"Hébergement",hostDetails:"Le site est hébergé par :",hetznerAddress:"Industriestr. 25 91710 Gunzenhausen, Germany",ovhAddress:"2 rue Kellermann – 59100 Roubaix – France",ip:"Propriété intellectuelle",ipText:"Tous les éléments du site Talkizi, y compris les textes, images, graphismes, logo, icônes, sons, logiciels, sont protégés par les lois en vigueur sur la propriété intellectuelle...",liability:"Responsabilité",liabilityText:"Talkizi s’efforce de fournir sur le site des informations aussi précises que possible...",contact:"Contact",contactText:"Pour toute question ou signalement, vous pouvez nous contacter à :"},terms:{title:"Conditions Générales d'Utilisation",sections:[{title:"1. Objet",content:"Les présentes Conditions Générales d'Utilisation (CGU) ont pour objet de définir les modalités et conditions dans lesquelles Talkizi met à disposition son service de salons vocaux et vidéo via un widget embarqué sur des sites tiers."},{title:"2. Acceptation",content:"En intégrant ou en utilisant le widget Talkizi, vous acceptez sans réserve les présentes CGU. Celles-ci peuvent être modifiées à tout moment par Talkizi ; il vous appartient de les consulter régulièrement."},{title:"3. Description du service",content:"Talkizi permet d’ajouter un salon vocal ou vidéo à un site web via un simple script. Les utilisateurs peuvent rejoindre un salon, échanger en temps réel par la voix, la vidéo ou le partage d’écran selon le plan choisi.",important:"Important : les flux audio, vidéo et écran transitent exclusivement en peer-to-peer via WebRTC et ne passent pas par les serveurs de Talkizi. Aucun enregistrement ni traitement des flux n’est effectué."},{title:"4. Engagements de l'utilisateur",content:"L'utilisateur s’engage à ne pas utiliser le service à des fins illicites, diffamatoires, ou portant atteinte aux droits d’autrui. Il est seul responsable des contenus échangés."},{title:"5. Responsabilité",content:"Talkizi fournit un service technique d’intermédiation de communication, sans surveillance ni contrôle du contenu échangé. Talkizi décline toute responsabilité en cas de litige entre utilisateurs ou en cas d’usage frauduleux."},{title:"6. Propriété",content:"Le code du widget, les interfaces et l’infrastructure sont la propriété exclusive de Talkizi. Toute reproduction, modification ou réutilisation sans autorisation est interdite."},{title:"7. Données personnelles",content:"Talkizi ne collecte aucune donnée personnelle via les salons vocaux/vidéo. Seules des données techniques nécessaires au fonctionnement du service (comme l’adresse IP pour établir une connexion WebRTC) sont temporairement utilisées sans stockage persistant."},{title:"8. Droit applicable",content:"Les présentes CGU sont soumises au droit français. Tout litige relatif à leur interprétation ou exécution sera de la compétence exclusive des tribunaux français."},{title:"9. Contact",content:"Pour toute question relative aux CGU, vous pouvez contacter :",email:"contact@talkizi.com"}]},privacy:{title:"Politique de confidentialité",sections:[{title:"1. Introduction",content:"Talkizi s'engage à protéger votre vie privée. Cette politique de confidentialité décrit la manière dont nous collectons, utilisons et protégeons vos informations personnelles lorsque vous utilisez notre site et notre widget vocal."},{title:"2. Données collectées",content:"Nous collectons uniquement les données strictement nécessaires au bon fonctionnement du service. Aucune donnée personnelle n’est requise pour accéder ou utiliser le widget Talkizi."},{title:"3. Utilisation des données",content:"Les éventuelles données collectées (logs techniques, adresse IP, préférences de langue) sont utilisées exclusivement pour :",list:["Assurer la sécurité et la stabilité du service","Améliorer l’expérience utilisateur","Analyser l’utilisation du site de façon anonyme"]},{title:"4. Partage des données",content:"Aucune donnée n’est vendue ou partagée à des tiers à des fins commerciales. Les données peuvent être transmises uniquement en cas d’obligation légale ou judiciaire."},{title:"5. Cookies",content:"Le site Talkizi utilise uniquement des cookies fonctionnels nécessaires au bon fonctionnement du service. Aucun cookie publicitaire ou de tracking tiers n’est utilisé."},{title:"6. Flux vocaux et vidéo",content:"Tous les flux vocaux et vidéo utilisés par Talkizi sont chiffrés et transmis en peer-to-peer via WebRTC. Ils ne transitent à aucun moment par les serveurs de Talkizi, garantissant une confidentialité maximale des échanges."},{title:"7. Vos droits",content:"Conformément au RGPD, vous disposez d’un droit d’accès, de rectification, de suppression et de portabilité de vos données. Pour toute demande, contactez-nous à :",email:"contact@talkizi.com"},{title:"8. Contact",content:"Pour toute question concernant cette politique de confidentialité, vous pouvez nous contacter à l'adresse suivante :",email:"contact@talkizi.com"}]},footer:{rights:"Tous droits réservés.",legal:"Mentions légales",terms:"Conditions",privacy:"Confidentialité"},header:{join:"Rejoindre",dashboard:"Mon espace"},config:{apiKey:"Clé API",show:"Afficher",hide:"Masquer",copy:"Copier",copied:"Copié !",rooms:"Rooms",roomName:"Nom de la room",description:"Description",addRoom:"+ Ajouter une room",remove:"Supprimer",urlsAllowed:"URLs autorisées",urlInvalid:"URL invalide",addUrl:"+ Ajouter une URL",plan:"Plan",free:"Gratuit",pro:"Pro",enterprise:"Entreprise",saveConfig:"💾 Sauvegarder",savedSuccess:"Configuration sauvegardée avec succès !",savedError:"Erreur lors de la sauvegarde",saveDisabledNoChange:"Aucune modification à sauvegarder",invalidUrls:"Une ou plusieurs URLs sont invalides",roomTrad:{options:{video:"Vidéo",screenShare:"Partage d'écran"}}},login:{subtitle:"Connexion sécurisée pour accéder à Talkizi.",google:"Se connecter avec Google",redirecting:"Redirection...",footer:"© 2025 Talkizi. Tous droits réservés."},docs:{title:"Documentation du widget Talkizi",intro:"Intégrez Talkizi en quelques secondes dans votre site HTML, React, Vue ou SolidJS.",advancedTitle:"Options avancées",advancedText:"Vous pouvez personnaliser le comportement du widget avec des attributs HTML.",keyDesc:"Clé publique de votre projet (obtenue sur le dashboard Talkizi).",showDesc:"Aficher ou masquer le widget par défaut.",apiTitle:"API JavaScript",apiIntro:"Le widget expose une API JS globale pour interagir avec lui :",faqTitle:"FAQ",faq:[{q:"Est-ce que le widget fonctionne sur mobile ?",a:"Oui, il est responsive et optimisé mobile."},{q:"Puis-je changer la langue du widget ?",a:"Oui, via une option dans le dashboard ou `setOptions()`."}],supportTitle:"Besoin d'aide ?",supportText:"Notre équipe vous répond dans les 24h ouvrées."},errors:{cardMissing:"Carte non trouvée ou pas accessible.",NO_PLAN_SPECIFIED:"Aucun plan spécifié.",UNKNOWN_PLAN:"Plan inconnu.",TOO_MANY_ROOMS:"Nombre de salons dépassé pour ce plan.",VIDEO_NOT_ALLOWED:"La vidéo n’est pas autorisée dans ce plan.",SCREENSHARE_NOT_ALLOWED:"Le partage d’écran n’est pas autorisé dans ce plan.",WEBHOOKS_NOT_ALLOWED:"Les webhooks ne sont pas disponibles dans ce plan.",PRIVATE_ACCESS_NOT_ALLOWED:"L’accès privé par token n’est pas autorisé dans ce plan.",CUSTOM_BRANDING_NOT_ALLOWED:"La personnalisation visuelle n’est pas disponible dans ce plan.",DEDICATED_HOSTING_NOT_ALLOWED:"L’hébergement dédié n’est pas inclus dans ce plan.",PRIORITY_SUPPORT_NOT_ALLOWED:"Le support prioritaire n’est pas inclus dans ce plan.",STATS_NOT_ALLOWED:"Ce plan ne permet pas l’option de statistiques sélectionnée."},planChange:{title:"💳 Vous avez changé de plan.",newPlan:"Nouveau plan",price:"Prix",chargeNotice:"💰 Le renouvellement sera facturé à l’issue de votre abonnement en cours.",priceExclVAT:"{{price}} /mois HT",priceInclVAT:"{{price}} /mois",priceOnRequest:"Sur devis"},payment:{title:"Paiement",cardAlreadyAdded:"Une carte est déjà enregistrée.",cardLabel:"Carte",expirationLabel:"Expiration",statusLabel:"Statut",addedOnLabel:"Ajoutée le",updateCardButton:"Mettre à jour ma carte",explanation1:"Pour activer ton compte (même pour la version gratuite), tu dois ajouter une carte bancaire. Aucune somme ne sera débitée pour l'offre gratuite. Cela permet uniquement de vérifier ton identité et d'éviter les abus.",explanation2:"L'ajout de ta carte prend moins d'une minute via notre partenaire sécurisé Stripe. Tu pourras ensuite gérer tes abonnements ou passer à une offre payante quand tu le souhaites.",addCardButton:"Ajouter ma carte maintenant",errorCreatingSession:"Une erreur est survenue, merci de réessayer."},dashboard:{loading:"Chargement en cours...",menu:"Menu",closeMenu:"Fermer le menu",sidebarTitle:"Mon espace",config:"Config",documentation:"Documentation",payment:"Paiement",account:"Mon compte",nameLabel:"Nom",emailLabel:"Email",idLabel:"ID",logout:"Se déconnecter",referralTitle:"Parrainage",referralLinkLabel:"Ton lien de parrainage",referralCountLabel:"Nombre de filleuls",earningsLabel:"Gains cumulés",copy:"Copier",copied:"Copié !",withdraw:"Demander un retrait",withdrawing:"Retrait en cours...",withdrawSuccess:"Ta demande de retrait a été envoyée !",withdrawError:"Une erreur est survenue pendant le retrait.",referralInfo:"Pour chaque filleul qui prend un abonnement, vous recevez 10% du montant HT chaque mois. Exemple : si votre filleul paie 19€ HT/mois pendant 2 ans → vous touchez environ 45,60€. Le retrait est possible à partir de 50€ cumulés."},modal:{openButton:"Salons vocaux",title:"Salons",currentRoom:"Salon actuel :",noRoom:"Aucun",selectRoom:"Sélectionne un salon.",connected:"Connecté ✅",notConnected:"Non connecté",leave:"Quitter",join:"Rejoindre vocal",defaultRoom:"Salon"},roomActions:{micOn:"Micro on",micOff:"Micro off",camOn:"Caméra on",camOff:"Caméra off",screenOn:"Écran on",screenOff:"Écran off",leave:"Quitter"}},en:{heroTitle:"Add an interactive voice room with one script.",heroSubtitle:"Talkizi instantly turns your site into a vibrant voice space — effortlessly.",cta:"Try Talkizi for free",why:"Why Talkizi?",whyPoints:[{title:"Ultra-lightweight",desc:"Only 10kb, fast and seamless.",icon:"⚡️"},{title:"Instant setup",desc:"Copy, paste, talk.",icon:"🚀"},{title:"Customizable",desc:"Match your brand.",icon:"🎨"},{title:"Boost engagement",desc:"Build active communities.",icon:"💬"}],love:"What they’ll love",snippetTitle:"Add Talkizi in 1 line",pricingTitle:"Pricing",plans:[{title:"Free",price:"€0 /month",desc:"1 voice room, audio only, up to 4 participants."},{title:"Starter",price:"€5 /monthn excl. VAT",desc:"1 room, audio + video + screen, up to 10 participants."},{title:"Pro",price:"€19 /month excl. VAT",desc:"3 rooms, audio + video + screen, up to 10 participants, basic stats."},{title:"Business",price:"€49 /month excl. VAT",desc:"10 private rooms, token access, 20 participants, advanced stats, webhooks, branding."},{title:"Enterprise",price:"Custom pricing",desc:"Unlimited rooms, advanced integration, dedicated hosting, priority support."}],faqTitle:"FAQ",faq:[{q:"Does Talkizi impact performance?",a:"No, it’s ultra-light and optimized for fast loading."},{q:"Can I customize the widget?",a:"Yes, customization is available starting from the Pro plan."},{q:"Do I need an account?",a:"No, you can integrate and try it instantly without creating an account."}],finalCta:"Ready to talk? Try it free!",legal:{title:"Legal notice",editor:"Site publisher",editorDetails:"The Talkizi website is published by:",talkiziInfo:"Talkizi",siret:"SIRET: 83747616700031",email:"Email: contact@talkizi.com",hosting:"Hosting",hostDetails:"The website is hosted by:",hetznerAddress:"Industriestr. 25 91710 Gunzenhausen, Germany",ovhAddress:"2 rue Kellermann – 59100 Roubaix – France",ip:"Intellectual property",ipText:"All elements of the Talkizi website, including texts, images, graphics, logos, icons, sounds, and software, are protected by applicable intellectual property laws...",liability:"Liability",liabilityText:"Talkizi strives to provide the most accurate information possible on its website...",contact:"Contact",contactText:"For any questions or reports, you can contact us at:"},terms:{title:"Terms of Use",sections:[{title:"1. Purpose",content:"These Terms of Use define the terms and conditions under which Talkizi provides its voice and video room service via an embedded widget on third-party websites."},{title:"2. Acceptance",content:"By embedding or using the Talkizi widget, you unreservedly accept these Terms of Use. They may be changed at any time by Talkizi; it is your responsibility to consult them regularly."},{title:"3. Service Description",content:"Talkizi allows you to add a voice or video room to a website using a simple script. Users can join a room and communicate in real time via voice, video, or screen sharing depending on the plan.",important:"Important: Audio, video, and screen streams are transmitted exclusively peer-to-peer via WebRTC and never pass through Talkizi’s servers. No recording or processing is done."},{title:"4. User Obligations",content:"The user agrees not to use the service for illegal, defamatory purposes or in violation of others' rights. They are solely responsible for the content exchanged."},{title:"5. Liability",content:"Talkizi provides a technical communication service with no monitoring or control over the content exchanged. Talkizi accepts no responsibility in the event of disputes or fraudulent use."},{title:"6. Ownership",content:"The widget code, interfaces, and infrastructure are the exclusive property of Talkizi. Any reproduction, modification, or reuse without permission is prohibited."},{title:"7. Personal Data",content:"Talkizi does not collect any personal data via its voice/video rooms. Only technical data necessary for the service (e.g. IP addresses to establish WebRTC connections) is temporarily used without persistent storage."},{title:"8. Governing Law",content:"These Terms are governed by French law. Any disputes relating to their interpretation or execution fall under the exclusive jurisdiction of French courts."},{title:"9. Contact",content:"For any questions related to these Terms of Use, contact:",email:"contact@talkizi.com"}]},privacy:{title:"Privacy Policy",sections:[{title:"1. Introduction",content:"Talkizi is committed to protecting your privacy. This privacy policy describes how we collect, use, and protect your personal information when using our website and voice widget."},{title:"2. Data Collected",content:"We only collect data strictly necessary for the proper operation of the service. No personal data is required to access or use the Talkizi widget."},{title:"3. Use of Data",content:"Collected data (technical logs, IP address, language preferences) is used exclusively for:",list:["Ensuring service security and stability","Improving user experience","Analyzing site usage anonymously"]},{title:"4. Data Sharing",content:"No data is sold or shared with third parties for commercial purposes. Data may only be transmitted when legally or judicially required."},{title:"5. Cookies",content:"The Talkizi website only uses functional cookies necessary for proper service operation. No advertising or third-party tracking cookies are used."},{title:"6. Voice and Video Streams",content:"All voice and video streams used by Talkizi are encrypted and transmitted peer-to-peer via WebRTC. They never pass through Talkizi servers, ensuring maximum confidentiality."},{title:"7. Your Rights",content:"In accordance with GDPR, you have the right to access, rectify, delete, and transfer your data. For any request, contact us at:",email:"contact@talkizi.com"},{title:"8. Contact",content:"For any questions regarding this privacy policy, you can contact us at:",email:"contact@talkizi.com"}]},footer:{rights:"All rights reserved.",legal:"Legal notice",terms:"Terms",privacy:"Privacy"},header:{join:"Join",dashboard:"My dashboard"},config:{apiKey:"API Key",show:"Show",hide:"Hide",copy:"Copy",copied:"Copied!",rooms:"Rooms",roomName:"Room name",description:"Description",addRoom:"+ Add a room",remove:"Remove",urlsAllowed:"Allowed URLs",urlInvalid:"Invalid URL",addUrl:"+ Add a URL",plan:"Plan",free:"Free",pro:"Pro",enterprise:"Enterprise",saveConfig:"💾 Save",savedSuccess:"Configuration saved successfully!",savedError:"Failed to save configuration.",saveDisabledNoChange:"No changes to save",invalidUrls:"One or more URLs are invalid",roomTrad:{options:{video:"Video",screenShare:"Screen Share"}}},login:{subtitle:"Secure login to access Talkizi.",google:"Sign in with Google",redirecting:"Redirecting...",footer:"© 2025 Talkizi. All rights reserved."},docs:{title:"Talkizi Widget Documentation",intro:"Integrate Talkizi in seconds into your HTML, React, Vue or SolidJS website.",advancedTitle:"Advanced Options",advancedText:"You can customize the widget's behavior using HTML attributes.",keyDesc:"Your project’s public key (available in the Talkizi dashboard).",showDesc:"Whether to show the widget by default (true/false).",apiTitle:"JavaScript API",apiIntro:"The widget exposes a global JavaScript API you can interact with:",faqTitle:"FAQ",faq:[{q:"Does the widget work on mobile?",a:"Yes, it is fully responsive and mobile-optimized."},{q:"Can I change the widget's language?",a:"Yes, via an option in the dashboard or using `setOptions()`."}],supportTitle:"Need help?",supportText:"Our team will get back to you within 24 business hours."},errors:{cardMissing:"Card not found or invalid",NO_PLAN_SPECIFIED:"No plan specified.",UNKNOWN_PLAN:"Unknown plan.",TOO_MANY_ROOMS:"Too many rooms for this plan.",VIDEO_NOT_ALLOWED:"Video is not allowed with this plan.",SCREENSHARE_NOT_ALLOWED:"Screen sharing is not allowed with this plan.",WEBHOOKS_NOT_ALLOWED:"Webhooks are not allowed with this plan.",PRIVATE_ACCESS_NOT_ALLOWED:"Private token access is not allowed with this plan.",CUSTOM_BRANDING_NOT_ALLOWED:"Custom branding is not allowed with this plan.",DEDICATED_HOSTING_NOT_ALLOWED:"Dedicated hosting is not available with this plan.",PRIORITY_SUPPORT_NOT_ALLOWED:"Priority support is not included in this plan.",STATS_NOT_ALLOWED:"This plan does not allow the selected statistics option."},planChange:{title:"💳 You changed your plan.",newPlan:"New plan",price:"Price",chargeNotice:"💰 You won’t be charged until your current subscription ends.",priceExclVAT:"{{price}} /month (excluding VAT)",priceInclVAT:"{{price}} /month",priceOnRequest:"On request"},payment:{title:"Payment",cardAlreadyAdded:"A card is already on file.",cardLabel:"Card",expirationLabel:"Expiration",statusLabel:"Status",addedOnLabel:"Added on",updateCardButton:"Update my card",explanation1:"To activate your account (even for the free plan), you must add a credit card. No charges will be made for the free offer. This is solely to verify your identity and prevent abuse.",explanation2:"Adding your card takes less than a minute via our secure partner Stripe. You'll then be able to manage your subscriptions or upgrade at any time.",addCardButton:"Add my card now",errorCreatingSession:"An error occurred, please try again."},dashboard:{loading:"Loading...",menu:"Menu",closeMenu:"Close menu",sidebarTitle:"My dashboard",config:"Settings",documentation:"Documentation",payment:"Payment",account:"My account",nameLabel:"Name",emailLabel:"Email",idLabel:"ID",logout:"Log out",referralTitle:"Referral Program",referralLinkLabel:"Your referral link",referralCountLabel:"Number of referrals",earningsLabel:"Total earnings",copy:"Copy",copied:"Copied!",withdraw:"Request Withdrawal",withdrawing:"Withdrawing...",withdrawSuccess:"Your withdrawal request has been sent!",withdrawError:"An error occurred during withdrawal.",referralInfo:"For each person you refer who subscribes, you receive 10% of the pre-tax amount every month. Example: if your referral pays €19 excl. tax/month for 2 years → you earn around €45.60. Withdrawals available once you reach €50."},modal:{openButton:"Voice rooms",title:"Rooms",currentRoom:"Current room:",noRoom:"None",selectRoom:"Select a room.",connected:"Connected ✅",notConnected:"Not connected",leave:"Leave",join:"Join voice",defaultRoom:"Room"},roomActions:{micOn:"Mic on",micOff:"Mic off",camOn:"Camera on",camOff:"Camera off",screenOn:"Screen on",screenOff:"Screen off",leave:"Leave"}}};var _i=w('<button><svg xmlns=http://www.w3.org/2000/svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor></svg><span>'),Tn=w("<button><span>"),bi=w('<button><svg xmlns=http://www.w3.org/2000/svg class="h-5 w-5"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M17 16l4-4m0 0l-4-4m4 4H7"></path></svg><span>'),Ci=w('<svg><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M9 5v14l12-7L9 5z"></svg>',!1,!0,!1),Si=w('<svg><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M5 5l14 14M15 10v4m0 0H9m6 0V6m0 0h6"></svg>',!1,!0,!1),ki=w('<svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke-width=1.5 stroke=currentColor class=size-6><path stroke-linecap=round stroke-linejoin=round d="m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M12 18.75H4.5a2.25 2.25 0 0 1-2.25-2.25V9m12.841 9.091L16.5 19.5m-1.409-1.409c.407-.407.659-.97.659-1.591v-9a2.25 2.25 0 0 0-2.25-2.25h-9c-.621 0-1.184.252-1.591.659m12.182 12.182L2.909 5.909M1.5 4.5l1.409 1.409">'),xi=w('<svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke-width=1.5 stroke=currentColor class=size-6><path stroke-linecap=round stroke-linejoin=round d="m15.75 10.5 4.72-4.72a.75.75 0 0 1 1.28.53v11.38a.75.75 0 0 1-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25h-9A2.25 2.25 0 0 0 2.25 7.5v9a2.25 2.25 0 0 0 2.25 2.25Z">'),Ti=w('<svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke-width=1.5 stroke=currentColor class=size-6><path stroke-linecap=round stroke-linejoin=round d="M3 3v18h18V3H3zm9 4v10M7 12h10">'),Ri=w('<svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"stroke-width=1.5 stroke=currentColor class=size-6><path stroke-linecap=round stroke-linejoin=round d="M3 3v18h18V3H3z">');function Ei(n){const{lang:e}=kn(),t=()=>xn[e()];return[(()=>{var r=_i(),i=r.firstChild,s=i.nextSibling;return ae(r,"click",n.onToggleMute),_(i,(()=>{var o=q(()=>!!n.isMuted);return()=>o()?Ci():Si()})()),_(s,(()=>{var o=q(()=>!!n.isMuted);return()=>o()?t().roomActions.micOff:t().roomActions.micOn})()),te(()=>Z(r,`inline-flex items-center gap-2 bg-yellow-500 hover:bg-yellow-600 text-white font-medium px-4 py-2 rounded-lg shadow transition ${n.fullScreen?"w-auto":"w-[48%]"}`)),r})(),(()=>{var r=Tn(),i=r.firstChild;return ae(r,"click",n.onToggleVideoEnabled),_(r,(()=>{var s=q(()=>!!n.isVideoEnabled);return()=>s()?ki():xi()})(),i),_(i,(()=>{var s=q(()=>!!n.isVideoEnabled);return()=>s()?t().roomActions.camOff:t().roomActions.camOn})()),te(()=>Z(r,`inline-flex items-center gap-2 bg-yellow-500 hover:bg-yellow-600 text-white font-medium px-4 py-2 rounded-lg shadow transition ${n.fullScreen?"w-auto":"w-[48%]"}`)),r})(),(()=>{var r=Tn(),i=r.firstChild;return ae(r,"click",n.onToggleScreenShare),_(r,(()=>{var s=q(()=>!!n.isScreenSharing);return()=>s()?Ti():Ri()})(),i),_(i,(()=>{var s=q(()=>!!n.isScreenSharing);return()=>s()?t().roomActions.screenOff:t().roomActions.screenOn})()),te(()=>Z(r,`inline-flex items-center gap-2 bg-yellow-500 hover:bg-yellow-600 text-white font-medium px-4 py-2 rounded-lg shadow transition ${n.fullScreen?"w-auto":"w-[48%]"}`)),r})(),(()=>{var r=bi(),i=r.firstChild,s=i.nextSibling;return ae(r,"click",n.onLeave),_(s,()=>t().roomActions.leave),te(()=>Z(r,`inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-medium px-4 py-2 rounded-lg shadow transition ${n.fullScreen?"w-auto":"w-[48%]"}`)),r})()]}Ie(["click"]);const ue=Object.create(null);ue.open="0",ue.close="1",ue.ping="2",ue.pong="3",ue.message="4",ue.upgrade="5",ue.noop="6";const ct=Object.create(null);Object.keys(ue).forEach(n=>{ct[ue[n]]=n});const It={type:"error",data:"parser error"},Rn=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",En=typeof ArrayBuffer=="function",wn=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Dt=({type:n,data:e},t,r)=>Rn&&e instanceof Blob?t?r(e):Pn(e,r):En&&(e instanceof ArrayBuffer||wn(e))?t?r(e):Pn(new Blob([e]),r):r(ue[n]+(e||"")),Pn=(n,e)=>{const t=new FileReader;return t.onload=function(){const r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(n)};function An(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let $t;function wi(n,e){if(Rn&&n.data instanceof Blob)return n.data.arrayBuffer().then(An).then(e);if(En&&(n.data instanceof ArrayBuffer||wn(n.data)))return e(An(n.data));Dt(n,!1,t=>{$t||($t=new TextEncoder),e($t.encode(t))})}const On="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<On.length;n++)qe[On.charCodeAt(n)]=n;const Pi=n=>{let e=n.length*.75,t=n.length,r,i=0,s,o,a,c;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const l=new ArrayBuffer(e),d=new Uint8Array(l);for(r=0;r<t;r+=4)s=qe[n.charCodeAt(r)],o=qe[n.charCodeAt(r+1)],a=qe[n.charCodeAt(r+2)],c=qe[n.charCodeAt(r+3)],d[i++]=s<<2|o>>4,d[i++]=(o&15)<<4|a>>2,d[i++]=(a&3)<<6|c&63;return l},Ai=typeof ArrayBuffer=="function",Mt=(n,e)=>{if(typeof n!="string")return{type:"message",data:Ln(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:Oi(n.substring(1),e)}:ct[t]?n.length>1?{type:ct[t],data:n.substring(1)}:{type:ct[t]}:It},Oi=(n,e)=>{if(Ai){const t=Pi(n);return Ln(t,e)}else return{base64:!0,data:n}},Ln=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},In="",Li=(n,e)=>{const t=n.length,r=new Array(t);let i=0;n.forEach((s,o)=>{Dt(s,!1,a=>{r[o]=a,++i===t&&e(r.join(In))})})},Ii=(n,e)=>{const t=n.split(In),r=[];for(let i=0;i<t.length;i++){const s=Mt(t[i],e);if(r.push(s),s.type==="error")break}return r};function Di(){return new TransformStream({transform(n,e){wi(n,t=>{const r=t.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const s=new DataView(i.buffer);s.setUint8(0,126),s.setUint16(1,r)}else{i=new Uint8Array(9);const s=new DataView(i.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(r))}n.data&&typeof n.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}let Bt;function lt(n){return n.reduce((e,t)=>e+t.length,0)}function ut(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let r=0;for(let i=0;i<e;i++)t[i]=n[0][r++],r===n[0].length&&(n.shift(),r=0);return n.length&&r<n[0].length&&(n[0]=n[0].slice(r)),t}function $i(n,e){Bt||(Bt=new TextDecoder);const t=[];let r=0,i=-1,s=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(r===0){if(lt(t)<1)break;const c=ut(t,1);s=(c[0]&128)===128,i=c[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(lt(t)<2)break;const c=ut(t,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),r=3}else if(r===2){if(lt(t)<8)break;const c=ut(t,8),l=new DataView(c.buffer,c.byteOffset,c.length),d=l.getUint32(0);if(d>Math.pow(2,21)-1){a.enqueue(It);break}i=d*Math.pow(2,32)+l.getUint32(4),r=3}else{if(lt(t)<i)break;const c=ut(t,i);a.enqueue(Mt(s?c:Bt.decode(c),e)),r=0}if(i===0||i>n){a.enqueue(It);break}}}})}const Dn=4;function z(n){if(n)return Mi(n)}function Mi(n){for(var e in z.prototype)n[e]=z.prototype[e];return n}z.prototype.on=z.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this},z.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this},z.prototype.off=z.prototype.removeListener=z.prototype.removeAllListeners=z.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this},z.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this},z.prototype.emitReserved=z.prototype.emit,z.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]},z.prototype.hasListeners=function(n){return!!this.listeners(n).length};const dt=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),se=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Bi="arraybuffer";function wo(){}function $n(n,...e){return e.reduce((t,r)=>(n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}const Ni=se.setTimeout,ji=se.clearTimeout;function ft(n,e){e.useNativeTimers?(n.setTimeoutFn=Ni.bind(se),n.clearTimeoutFn=ji.bind(se)):(n.setTimeoutFn=se.setTimeout.bind(se),n.clearTimeoutFn=se.clearTimeout.bind(se))}const zi=1.33;function Ui(n){return typeof n=="string"?Fi(n):Math.ceil((n.byteLength||n.size)*zi)}function Fi(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function Mn(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function qi(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function Vi(n){let e={},t=n.split("&");for(let r=0,i=t.length;r<i;r++){let s=t[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class Hi extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class Nt extends z{constructor(e){super(),this.writable=!1,ft(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new Hi(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Mt(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=qi(e);return t.length?"?"+t:""}}class Wi extends Nt{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Ii(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Li(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Mn()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Bn=!1;try{Bn=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Gi=Bn;function Ki(){}class Ji extends Wi{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let r=location.port;r||(r=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}}class de extends z{constructor(e,t,r){super(),this.createRequest=e,ft(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const t=$n(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=de.requestsCount++,de.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Ki,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete de.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(de.requestsCount=0,de.requests={},typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Nn);else if(typeof addEventListener=="function"){const n="onpagehide"in se?"pagehide":"unload";addEventListener(n,Nn,!1)}}function Nn(){for(let n in de.requests)de.requests.hasOwnProperty(n)&&de.requests[n].abort()}const Yi=function(){const n=jn({xdomain:!1});return n&&n.responseType!==null}();class Qi extends Ji{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Yi&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new de(jn,this.uri(),e)}}function jn(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Gi))return new XMLHttpRequest}catch{}if(!e)try{return new se[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const zn=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Xi extends Nt{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,r=zn?{}:$n(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],i=t===e.length-1;Dt(r,this.supportsBinary,s=>{try{this.doWrite(r,s)}catch{}i&&dt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Mn()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const jt=se.WebSocket||se.MozWebSocket;class Zi extends Xi{createSocket(e,t,r){return zn?new jt(e,t,r):t?new jt(e,t):new jt(e)}doWrite(e,t){this.ws.send(t)}}class es extends Nt{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=$i(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),i=Di();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const s=()=>{r.read().then(({done:a,value:c})=>{a||(this.onPacket(c),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],i=t===e.length-1;this._writer.write(r).then(()=>{i&&dt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const ts={websocket:Zi,webtransport:es,polling:Qi},ns=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,rs=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function zt(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),r=n.indexOf("]");t!=-1&&r!=-1&&(n=n.substring(0,t)+n.substring(t,r).replace(/:/g,";")+n.substring(r,n.length));let i=ns.exec(n||""),s={},o=14;for(;o--;)s[rs[o]]=i[o]||"";return t!=-1&&r!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=is(s,s.path),s.queryKey=ss(s,s.query),s}function is(n,e){const t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function ss(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,s){i&&(t[i]=s)}),t}const Ut=typeof addEventListener=="function"&&typeof removeEventListener=="function",ht=[];Ut&&addEventListener("offline",()=>{ht.forEach(n=>n())},!1);class Se extends z{constructor(e,t){if(super(),this.binaryType=Bi,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const r=zt(e);t.hostname=r.host,t.secure=r.protocol==="https"||r.protocol==="wss",t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=zt(t.host).host);ft(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Vi(this.opts.query)),Ut&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ht.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Dn,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Se.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Se.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(t+=Ui(i)),r>0&&t>this._maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,dt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,i){if(typeof t=="function"&&(i=t,t=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:e,data:t,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(Se.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ut&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=ht.indexOf(this._offlineEventListener);r!==-1&&ht.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Se.protocol=Dn;class os extends Se{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;Se.priorWebsocketSuccess=!1;const i=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",u=>{if(!r)if(u.type==="pong"&&u.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Se.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(d(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=t.name,this.emitReserved("upgradeError",f)}}))};function s(){r||(r=!0,d(),t.close(),t=null)}const o=u=>{const f=new Error("probe error: "+u);f.transport=t.name,s(),this.emitReserved("upgradeError",f)};function a(){o("transport closed")}function c(){o("socket closed")}function l(u){t&&u.name!==t.name&&s()}const d=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),this.off("close",c),this.off("upgrading",l)};t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",l),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}let as=class extends os{constructor(e,t={}){const r=typeof e=="object"?e:t;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>ts[i]).filter(i=>!!i)),super(e,r)}};function cs(n,e="",t){let r=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),r=zt(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+e,r.href=r.protocol+"://"+s+(t&&t.port===r.port?"":":"+r.port),r}const ls=typeof ArrayBuffer=="function",us=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Un=Object.prototype.toString,ds=typeof Blob=="function"||typeof Blob<"u"&&Un.call(Blob)==="[object BlobConstructor]",fs=typeof File=="function"||typeof File<"u"&&Un.call(File)==="[object FileConstructor]";function Ft(n){return ls&&(n instanceof ArrayBuffer||us(n))||ds&&n instanceof Blob||fs&&n instanceof File}function pt(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(pt(n[t]))return!0;return!1}if(Ft(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return pt(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&pt(n[t]))return!0;return!1}function hs(n){const e=[],t=n.data,r=n;return r.data=qt(t,e),r.attachments=e.length,{packet:r,buffers:e}}function qt(n,e){if(!n)return n;if(Ft(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<n.length;r++)t[r]=qt(n[r],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=qt(n[r],e));return t}return n}function ps(n,e){return n.data=Vt(n.data,e),delete n.attachments,n}function Vt(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=Vt(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=Vt(n[t],e));return n}const ms=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],gs=5;var T;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(T||(T={}));class ys{constructor(e){this.replacer=e}encode(e){return(e.type===T.EVENT||e.type===T.ACK)&&pt(e)?this.encodeAsBinary({type:e.type===T.EVENT?T.BINARY_EVENT:T.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===T.BINARY_EVENT||e.type===T.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=hs(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}}function Fn(n){return Object.prototype.toString.call(n)==="[object Object]"}class Ht extends z{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===T.BINARY_EVENT;r||t.type===T.BINARY_ACK?(t.type=r?T.EVENT:T.ACK,this.reconstructor=new vs(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(Ft(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(T[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===T.BINARY_EVENT||r.type===T.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(s,t)}else r.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const s=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}r.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(Ht.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case T.CONNECT:return Fn(t);case T.DISCONNECT:return t===void 0;case T.CONNECT_ERROR:return typeof t=="string"||Fn(t);case T.EVENT:case T.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&ms.indexOf(t[0])===-1);case T.ACK:case T.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class vs{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=ps(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const _s=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ht,Encoder:ys,get PacketType(){return T},protocol:gs},Symbol.toStringTag,{value:"Module"}));function ce(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const bs=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class qn extends z{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[ce(e,"open",this.onopen.bind(this)),ce(e,"packet",this.onpacket.bind(this)),ce(e,"error",this.onerror.bind(this)),ce(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,i,s;if(bs.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:T.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const d=this.ids++,u=t.pop();this._registerAckCallback(d,u),o.id=d}const a=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,c=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a||(c?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},i),o=(...a)=>{this.io.clearTimeoutFn(s),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((r,i)=>{const s=(o,a)=>o?i(o):r(a);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:T.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case T.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case T.EVENT:case T.BINARY_EVENT:this.onevent(e);break;case T.ACK:case T.BINARY_ACK:this.onack(e);break;case T.DISCONNECT:this.ondisconnect();break;case T.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...i){r||(r=!0,t.packet({type:T.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:T.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function Me(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Me.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=(Math.floor(e*10)&1)==0?n-t:n+t}return Math.min(n,this.max)|0},Me.prototype.reset=function(){this.attempts=0},Me.prototype.setMin=function(n){this.ms=n},Me.prototype.setMax=function(n){this.max=n},Me.prototype.setJitter=function(n){this.jitter=n};class Wt extends z{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,ft(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Me({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||_s;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new as(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=ce(t,"open",function(){r.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=ce(t,"error",s);if(this._timeout!==!1){const a=this._timeout,c=this.setTimeoutFn(()=>{i(),s(new Error("timeout")),t.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(ce(e,"ping",this.onping.bind(this)),ce(e,"data",this.ondata.bind(this)),ce(e,"error",this.onerror.bind(this)),ce(e,"close",this.onclose.bind(this)),ce(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){dt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new qn(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t)if(this.nsps[r].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Ve={};function mt(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=cs(n,e.path||"/socket.io"),r=t.source,i=t.id,s=t.path,o=Ve[i]&&s in Ve[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return a?c=new Wt(r,e):(Ve[i]||(Ve[i]=new Wt(r,e)),c=Ve[i]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}Object.assign(mt,{Manager:Wt,Socket:qn,io:mt,connect:mt});function Cs(n){var Gr,Kr,Jr,Yr;const[e,t]=O(!1),[r,i]=O(!1),[s,o]=O(null),[a,c]=O(null),[l,d]=O(null),[u,f]=O(null),[m,E]=O(new Map),[C,fe]=O(!1),[he,H]=O(!1),[ee,I]=O(new Map),[pe,S]=O(new Map),[oe,ne]=O(new Map),[Ae,re]=O(new Map),[me,ke]=O(!1),[ie,D]=O(null),U="talkizi.com",Ne=((Gr=window.location.hostname)!=null&&Gr.includes("local")||(Kr=window.location.hostname)!=null&&Kr.includes("192.168"))&&!(U!=null&&U.includes("talk"))?parseInt(void 0):443,v=((Jr=window.location.hostname)!=null&&Jr.includes("local")||(Yr=window.location.hostname)!=null&&Yr.includes("192.168"))&&!(U!=null&&U.includes("talk"))?parseInt(void 0):443,y=mt(`https://${U}:${Ne}`);function $(){var x;if(!u())return;const g=(x=u())==null?void 0:x.getAudioTracks()[0];if(!g)return;const R=!r();g.enabled=!R,i(R)}function B(){if(!s()||C())return;fe(!0);const g=l(),R=s(),x=n.rooms.map(p=>p._id),J=x.join(",");if(document.querySelectorAll("audio").forEach(p=>{try{p.pause(),p.srcObject=null,p.remove()}catch{}}),y.emit("leave-room",{roomId:R,clientId:(g==null?void 0:g.id)??"unknown",groupRooms:x,groupId:J}),y.emit("get-all-counts",{rooms:n.rooms.map(p=>p._id),groupRooms:n.rooms.map(p=>p._id)}),Ae().forEach(p=>{try{p.close()}catch{}}),re(new Map),X(),g)try{g.disconnect(),g.destroy()}catch{}d(null);const k=u();k&&k.getTracks().forEach(p=>p.stop()),f(null),I(new Map),D(null),S(new Map),H(!1),o(null),c(null),fe(!1)}async function ge(g){B(),c(`Connexion à ${g.name}...`);const{Peer:R}=await Promise.resolve().then(()=>xo),x=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});f(x);const J=`${g._id}-${crypto.randomUUID()}`,k=new R(J,{host:U,secure:!0,port:v,path:"/voice"});d(k),o(g._id),k.on("open",p=>{c(`Connecté à ${g.name} ✅`),y.emit("join-room",{roomId:g._id,clientId:p,groupRooms:n.rooms.map(b=>b._id),groupId:n.rooms.map(b=>b._id).join(",")}),y.emit("ask-video-states",{roomId:g._id,requesterId:p}),y.emit("get-all-counts",{rooms:n.rooms.map(b=>b._id),groupRooms:n.rooms.map(b=>b._id)}),y.emit("please-call-me",{requesterId:p})}),k.on("call",p=>{var P;const b=((P=p.metadata)==null?void 0:P.type)??"camera";b==="screen"?p.answer():p.answer(u()),re(N=>new Map(N.set(p.peer,p))),p.on("stream",N=>{b==="screen"?S(Qe=>new Map(Qe.set(p.peer,N))):I(Qe=>new Map(Qe.set(p.peer,N)));const F=new Audio;F.srcObject=N,F.autoplay=!0,F.play().catch(Qe=>console.warn("Impossible de jouer le son",Qe))}),p.on("close",()=>{b==="screen"?S(N=>{const F=new Map(N);return F.delete(p.peer),F}):I(N=>{const F=new Map(N);return F.delete(p.peer),F})})}),k.on("disconnected",()=>{C()||(c("Déconnecté"),B())})}async function K(){const g=l();if(g)if(me())X();else try{const R=await navigator.mediaDevices.getDisplayMedia({video:!0});D(R),ke(!0);const x=R.getVideoTracks()[0];y.emit("screen-on",{roomId:s(),peerId:g.id}),g.listAllPeers(J=>{J.filter(k=>k!==g.id&&k.startsWith(`${s()}-`)).forEach(k=>{const p=g.call(k,R,{metadata:{type:"screen"}});re(b=>new Map(b.set(p.peer,p))),p.on("stream",b=>{S(P=>new Map(P.set(p.peer,b)))}),p.on("close",()=>{S(b=>{const P=new Map(b);return P.delete(p.peer),P})})})}),x.onended=()=>{X()}}catch(R){console.error("Erreur lors du partage d’écran :",R)}}function X(){const g=ie();if(!g)return;const R=g.getVideoTracks()[0];R&&R.stop(),ke(!1),D(null);const x=l();x&&(y.emit("screen-off",{roomId:s(),peerId:x.id}),Ae().forEach((J,k)=>{var P;const p=(P=J._localStream)==null?void 0:P.getVideoTracks();(p==null?void 0:p.some(N=>N.label.toLowerCase().includes("screen")))&&(J.close(),S(N=>{const F=new Map(N);return F.delete(k),F}),re(N=>{const F=new Map(N);return F.delete(k),F}))}))}async function ye(){const g=u();if(!g)return;let R=g.getVideoTracks()[0];const x=l();if(R)R.enabled=!R.enabled,H(R.enabled),y.emit(R.enabled?"video-on":"video-off",{roomId:s(),peerId:x==null?void 0:x.id}),R.enabled&&x&&x.listAllPeers(J=>{J.filter(k=>k!==x.id&&k.startsWith(`${s()}-`)).forEach(k=>{const p=x.call(k,g);re(b=>new Map(b.set(p.peer,p))),p.on("stream",b=>{I(P=>new Map(P.set(p.peer,b)))}),p.on("close",()=>{I(b=>{const P=new Map(b);return P.delete(p.peer),P})})})});else try{const k=(await navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0];k&&(g.addTrack(k),H(!0),y.emit("video-on",{roomId:s(),peerId:x==null?void 0:x.id}),x&&x.listAllPeers(p=>{p.filter(b=>b!==x.id&&b.startsWith(`${s()}-`)).forEach(b=>{const P=x.call(b,g,{metadata:{type:"camera"}});re(N=>new Map(N.set(P.peer,P))),P.on("stream",N=>{I(F=>new Map(F.set(P.peer,N)))}),P.on("close",()=>{I(N=>{const F=new Map(N);return F.delete(P.peer),F})})})}))}catch(J){console.error("Erreur caméra",J)}}y.on("all-participant-counts",g=>{E(new Map(Object.entries(g)))}),y.on("remote-video-off",({peerId:g})=>{ne(R=>new Map(R.set(g,!1))),I(R=>{const x=new Map(R);return x.delete(g),x})}),y.on("remote-video-on",({peerId:g})=>{console.log(`Video activée pour ${g}`),ne(R=>new Map(R.set(g,!0)))}),y.on("request-video-state",({requesterId:g})=>{var x;const R=(x=l())==null?void 0:x.id;R&&y.emit(he()?"video-on":"video-off",{roomId:s(),peerId:R})});function Hr(){c("Plus de réseau ❌"),B()}function Wr(){c("Connexion rétablie ✅"),y.emit("get-all-counts",{rooms:n.rooms.map(g=>g._id),groupRooms:n.rooms.map(g=>g._id)})}return window.addEventListener("offline",Hr),window.addEventListener("online",Wr),Pt(()=>{window.removeEventListener("offline",Hr),window.removeEventListener("online",Wr)}),y.emit("subscribe-group",{groupId:n.rooms.map(g=>g._id).join(",")}),y.on("please-call-me",({requesterId:g})=>{const R=l();if(!R)return;const x=u(),J=ie();if(x){const k=R.call(g,x,{metadata:{type:"camera"}});re(p=>new Map(p.set(k.peer,k))),k.on("stream",p=>{I(P=>new Map(P.set(k.peer,p)));const b=new Audio;b.srcObject=p,b.autoplay=!0,b.play().catch(P=>console.warn("Impossible de jouer le son",P))}),k.on("close",()=>{I(p=>{const b=new Map(p);return b.delete(k.peer),b})})}if(J){const k=R.call(g,J,{metadata:{type:"screen"}});re(p=>new Map(p.set(k.peer,k))),k.on("stream",p=>{S(b=>new Map(b.set(k.peer,p)))}),k.on("close",()=>{S(p=>{const b=new Map(p);return b.delete(k.peer),b})})}}),y.emit("get-all-counts",{rooms:n.rooms.map(g=>g._id),groupRooms:n.rooms.map(g=>g._id)}),{visible:e,isMuted:r,joinedRoom:s,status:a,roomParticipantCounts:m,open:()=>t(!0),close:B,leaveAndClose:()=>{B(),t(!1)},joinRoom:ge,leaveRoom:B,toggleMute:$,localStream:u,isVideoEnabled:he,toggleVideo:ye,remoteStreams:ee,remoteVideoStates:oe,toggleScreenShare:K,remoteScreenStreams:pe,stopScreenShare:X,screenStream:ie,isScreenSharing:me}}var Ss=w('<div class="flex items-center gap-2"><button title="Plein écran"class="flex items-center gap-1 text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full px-2 py-1 transition"><svg xmlns=http://www.w3.org/2000/svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M8 3H5a2 2 0 0 0-2 2v3m0 8v3a2 2 0 0 0 2 2h3m8-16h3a2 2 0 0 1 2 2v3m0 8v3a2 2 0 0 1-2 2h-3"></path></svg></button><button class="flex items-center gap-1 text-gray-500 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full px-2 py-1 transition"></button><button class="flex items-center gap-1 text-red-500 hover:bg-red-100 dark:hover:bg-red-900 rounded-full px-2 py-1 transition"title=Fermer><svg xmlns=http://www.w3.org/2000/svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M6 18L18 6M6 6l12 12">'),ks=w('<svg xmlns=http://www.w3.org/2000/svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 4h7M4 4v7M20 20h-7M20 20v-7">'),xs=w('<svg xmlns=http://www.w3.org/2000/svg class="h-4 w-4"fill=none viewBox="0 0 24 24"stroke=currentColor><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 4h7M4 4v7M20 20h-7M20 20v-7"></path> ');function Vn(n){return(()=>{var e=Ss(),t=e.firstChild,r=t.nextSibling,i=r.nextSibling;return ae(t,"click",n.onToogleFullScreen),ae(r,"click",n.onToggleExpand),_(r,(()=>{var s=q(()=>!!n.isExpanded);return()=>s()?ks():xs()})()),ae(i,"click",n.onClose),te(()=>fi(r,"title",n.isExpanded?"Réduire":"Agrandir")),e})()}Ie(["click"]);var Ts=w('<div class="relative cursor-zoom-in w-full max-w-1/4 max-h-[300px] rounded-md overflow-hidden"><video muted class="w-full h-auto rounded object-cover"autoplay playsinline>'),Rs=w('<div class="z-10 mt-6 flex gap-2 overflow-x-auto px-4 py-2 bg-black/60 rounded-lg">'),Es=w('<div class="fixed inset-0 bg-black/90 z-50 flex flex-col items-center justify-center"><div class="absolute inset-0"></div><video muted class="max-w-full max-h-full z-10 rounded-lg shadow-2xl"autoplay playsinline>'),ws=w('<video muted class="w-24 h-16 rounded object-cover border border-white/20"autoplay playsinline>'),Ps=w('<div class="w-full max-w-1/4 max-h-[300px] rounded-md bg-black flex items-center justify-center text-white">📷 Caméra désactivée');function As(n){let e,t;const[r,i]=O(!1);rt(()=>{if(e&&n.stream&&n.isVideoEnabled){const o=n.stream.getVideoTracks().some(a=>a.readyState==="live");e.srcObject=o?n.stream:null,e.onloadedmetadata=()=>e==null?void 0:e.play().catch(console.warn)}}),rt(()=>{r()&&t&&n.stream&&(t.srcObject=n.stream,t.onloadedmetadata=()=>t==null?void 0:t.play().catch(console.warn))});const s=o=>{o.key==="Escape"&&i(!1)};return rt(()=>{r()?window.addEventListener("keydown",s):window.removeEventListener("keydown",s),Pt(()=>window.removeEventListener("keydown",s))}),n.isVideoEnabled?[(()=>{var o=Ts(),a=o.firstChild;return o.$$click=()=>i(!0),Fe(c=>e=c,a),o})(),L(Le,{get when(){return r()},get children(){var o=Es(),a=o.firstChild,c=a.nextSibling;return a.$$click=()=>i(!1),Fe(l=>t=l,c),_(o,L(Le,{get when(){return n.peers&&n.peers.length>0},get children(){var l=Rs();return _(l,L(ot,{get each(){return n.peers},children:d=>(()=>{var u=ws();return Fe(f=>{f.srcObject=d.stream,f.onloadedmetadata=()=>f.play().catch(console.warn)},u),u})()})),l}}),null),o}})]:Ps()}Ie(["click"]);var Os=w('<a href=https://talkizi.com target=_blank rel="noopener noreferrer"><span>Powered by</span><span class="font-semibold text-indigo-600">Talkizi');function Hn(n){return(()=>{var e=Os();return te(()=>Z(e,`flex items-center justify-center gap-1 text-xs text-gray-400 hover:text-indigo-500 transition-colors ${n.class??""}`)),e})()}var Ls=w('<div class="z-10 mt-6 flex gap-2 overflow-x-auto px-4 py-2 bg-black/60 rounded-lg max-w-full">'),Is=w('<div class="fixed inset-0 bg-black/90 z-50 flex flex-col items-center justify-center"><div class="absolute inset-0 cursor-zoom-out"></div><video muted autoplay playsinline class="z-10 max-w-full max-h-full rounded-xl shadow-2xl">'),Ds=w("<video muted autoplay playsinline>");function $s(n){return(()=>{var e=Is(),t=e.firstChild,r=t.nextSibling;return ae(t,"click",n.onClose),Fe(i=>{i.srcObject=n.current.stream,i.onloadedmetadata=()=>i.play().catch(console.warn)},r),_(e,L(Le,{get when(){return n.all.length>1},get children(){var i=Ls();return _(i,L(ot,{get each(){return n.all},children:s=>(()=>{var o=Ds();return o.$$click=a=>{a.stopPropagation(),n.onSelect(s.id)},Fe(a=>{a.srcObject=s.stream,a.onloadedmetadata=()=>a.play().catch(console.warn)},o),te(()=>Z(o,`w-24 h-16 rounded cursor-pointer border ${s.id===n.current.id?"border-white":"border-transparent"}`)),o})()})),i}}),null),e})()}Ie(["click"]);var Ms=w('<div class="w-full h-[40vh] flex flex-col items-center justify-center gap-4"><svg class="animate-spin h-10 w-10 text-indigo-600"xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"><circle class=opacity-25 cx=12 cy=12 r=10 stroke=currentColor stroke-width=4></circle><path class=opacity-75 fill=currentColor d="M4 12a8 8 0 018-8v4A4 4 0 008 12H4z"></path></svg><p class="text-lg font-medium text-gray-700 dark:text-gray-200">Un agent arrive…</p><p class="text-xs text-gray-500">Merci de patienter, la connexion va se lancer automatiquement.'),Bs=w('<button class="fixed bottom-6 right-6 z-50 bg-gradient-to-br from-indigo-600 to-purple-500 text-white px-5 py-3 rounded-full shadow-2xl hover:scale-105 transition-all duration-200 flex items-center gap-3"><span>'),Ns=w('<div><div><div><h2></h2></div><div class="flex-1 overflow-y-auto"><div></div><div></div></div><div class="border-t p-4 border-gray-200 dark:border-gray-700"><h3></h3><p class="text-base font-bold text-gray-900 dark:text-white"></p><p class="text-xs text-gray-500 mt-1">'),js=w('<div class="flex gap-2">'),zs=w('<div class="mt-4 flex gap-2 flex-wrap justify-center">'),Us=w('<div class="fixed bottom-6 right-6 z-50"><div class="w-[260px] bg-white dark:bg-gray-900 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 flex flex-col transition-all"><div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"><h2 class="text-sm font-semibold text-gray-800 dark:text-white"></h2></div><div class="p-3 flex flex-col gap-2"><p class="text-xs text-gray-500"></p><div class="flex gap-2 flex-wrap">'),Fs=w('<button class="bg-yellow-600 hover:bg-yellow-700 text-white px-2 py-1 rounded text-xs">'),qs=w('<button class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs">'),Vs=w('<button class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs">');function Hs(){return Ms()}function Ws(n){const[e,t]=O(null),[r,i]=O("expanded"),[s,o]=O(null),[a,c]=O(!1),[l,d]=O(null),u=()=>r()==="fullscreen",f=()=>r()==="expanded",m=()=>r()==="minimized",{lang:E}=kn(),C=()=>xn[E()];Zr(()=>{var S,oe;if((S=n.config)!=null&&S.talkiziId){const ne=new URLSearchParams(window.location.search);if(c(ne.get("support")==="true"),fe(),a()){if(n.config.rooms.length===0)throw new Error("Le mode support ne peut être activé que si une seule room est configurée.");d(n.config.rooms[0]),(oe=e())==null||oe.joinRoom(n.config.rooms[0])}}});const fe=()=>{if(e())e().open();else{const S=Cs(n.config);t(S),S.open()}},he=()=>{i(m()?"expanded":"minimized")},H=()=>{i(S=>S==="fullscreen"?"expanded":"fullscreen")},ee=()=>a()?"fixed inset-0 bg-black/40 backdrop-blur-sm flex items-center justify-center z-50":"fixed inset-0 bg-black/40 backdrop-blur-sm flex justify-end z-50",I=()=>a()?"w-[92vw] max-w-[780px] h-[84vh] bg-white dark:bg-gray-900 rounded-2xl shadow-2xl flex flex-col transition-all":`h-full bg-white dark:bg-gray-900 rounded-l-xl shadow-lg flex flex-col transition-all ${u()?"w-full":"sm:w-[400px]"}`,pe=()=>a()?"px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center rounded-t-2xl":"px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center";return[L(Le,{get when(){var S;return!((S=e())!=null&&S.visible())},get children(){var S=Bs(),oe=S.firstChild;return S.$$click=fe,_(oe,()=>C().modal.openButton),_(S,L(Hn,{}),null),S}}),q(()=>q(()=>{var S;return!!((S=e())!=null&&S.visible()&&!m())})()&&(()=>{var S=Ns(),oe=S.firstChild,ne=oe.firstChild,Ae=ne.firstChild,re=ne.nextSibling,me=re.firstChild,ke=me.nextSibling,ie=re.nextSibling,D=ie.firstChild,U=D.nextSibling,Ne=U.nextSibling;return S.$$click=v=>{var y;v.target===v.currentTarget&&((y=e())==null||y.leaveAndClose())},_(Ae,(()=>{var v=q(()=>!!a());return()=>v()?"Support":C().modal.title})()),_(ne,(()=>{var v=q(()=>!a());return()=>v()&&L(Vn,{onToogleFullScreen:H,get isFullScreen(){return u()},get isExpanded(){return f()},onExpand:()=>i("expanded"),onToggleExpand:he,get onClose(){return e().leaveAndClose}})})(),null),_(me,(()=>{var v=q(()=>!a());return()=>v()&&L(ot,{get each(){return n.config.rooms},children:y=>(()=>{var $=js();return _($,L(yi,{get plan(){return n.config.plan},get fullScreen(){return u()},room:y,get joinedRoomId(){return e().joinedRoom()},get count(){var B;return((B=e())==null?void 0:B.roomParticipantCounts().get(y._id))??0},onJoin:()=>{var B;return(B=e())==null?void 0:B.joinRoom(y)}})),$})()})})(),null),_(me,(()=>{var v=q(()=>{var y,$;return!!(a()&&(($=e())==null?void 0:$.roomParticipantCounts().get((y=l())==null?void 0:y._id))===1)});return()=>v()&&L(Hs,{})})(),null),_(ke,L(ot,{get each(){var v,y,$,B,ge;return[...(v=e())!=null&&v.localStream()&&((y=e())!=null&&y.isVideoEnabled())?[{id:"local",stream:($=e())==null?void 0:$.localStream(),isVideoEnabled:!0}]:[],...(B=e())!=null&&B.screenStream()?[{id:"local-screen",stream:(ge=e())==null?void 0:ge.screenStream(),isVideoEnabled:!0}]:[],...Array.from(e().remoteStreams().entries()).map(([K,X])=>{var ye;return{id:K,stream:X,isVideoEnabled:((ye=e())==null?void 0:ye.remoteVideoStates().get(K))??!0}}),...Array.from(e().remoteScreenStreams().entries()).map(([K,X])=>({id:`${K}-screen`,stream:X,isVideoEnabled:!0}))]},children:v=>L(As,{get stream(){return v.stream},get isVideoEnabled(){return v.isVideoEnabled},peers:[]})}),null),_(ke,L(Le,{get when(){return s()},get children(){return L($s,{get current(){var v,y,$,B,ge;return[...(v=e())!=null&&v.localStream()&&((y=e())!=null&&y.isVideoEnabled())?[{id:"local",stream:($=e())==null?void 0:$.localStream(),isVideoEnabled:!0}]:[],...(B=e())!=null&&B.screenStream()?[{id:"local-screen",stream:(ge=e())==null?void 0:ge.screenStream(),isVideoEnabled:!0}]:[],...Array.from(e().remoteStreams().entries()).map(([K,X])=>{var ye;return{id:K,stream:X,isVideoEnabled:((ye=e())==null?void 0:ye.remoteVideoStates().get(K))??!0}}),...Array.from(e().remoteScreenStreams().entries()).map(([K,X])=>({id:`${K}-screen`,stream:X,isVideoEnabled:!0}))].find(K=>K.id===s())},all:[],onSelect:o,onClose:()=>o(null)})}}),null),_(D,()=>C().modal.currentRoom),_(U,()=>{var v;return((v=n.config.rooms.find(y=>{var $;return y._id===(($=e())==null?void 0:$.joinedRoom())}))==null?void 0:v.name)??C().modal.noRoom}),_(Ne,()=>{var v;return((v=e())==null?void 0:v.status())??C().modal.selectRoom}),_(ie,(()=>{var v=q(()=>{var y;return!!((y=e())!=null&&y.joinedRoom())});return()=>v()&&(()=>{var y=zs();return _(y,L(Ei,{get fullScreen(){return u()},get isMuted(){return e().isMuted()},get onToggleMute(){return e().toggleMute},get onLeave(){return e().leaveRoom},get onToggleVideoEnabled(){return e().toggleVideo},get isVideoEnabled(){return e().isVideoEnabled()},get onToggleScreenShare(){return e().toggleScreenShare},get isScreenSharing(){var $;return($=e())==null?void 0:$.isScreenSharing()}})),y})()})(),null),_(oe,L(Hn,{}),null),te(v=>{var y=ee(),$=I(),B=pe(),ge=a()?"text-lg font-semibold":"text-lg font-semibold text-gray-800 dark:text-white",K=`flex ${u()?"flex-row gap-4":"flex-col gap-4 "} p-4`,X=`flex flex-row flex-wrap gap-4 w-full justify-start p-4 ${a()?"bg-white dark:bg-gray-900":""}`,ye=(a(),"text-sm font-semibold text-gray-700 dark:text-gray-200 mb-1");return y!==v.e&&Z(S,v.e=y),$!==v.t&&Z(oe,v.t=$),B!==v.a&&Z(ne,v.a=B),ge!==v.o&&Z(Ae,v.o=ge),K!==v.i&&Z(me,v.i=K),X!==v.n&&Z(ke,v.n=X),ye!==v.s&&Z(D,v.s=ye),v},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),S})()),q(()=>q(()=>{var S;return!!((S=e())!=null&&S.visible()&&m())})()&&(()=>{var S=Us(),oe=S.firstChild,ne=oe.firstChild,Ae=ne.firstChild,re=ne.nextSibling,me=re.firstChild,ke=me.nextSibling;return _(Ae,()=>{var ie;return((ie=n.config.rooms[0])==null?void 0:ie.name)??C().modal.defaultRoom}),_(ne,L(Vn,{get isFullScreen(){return u()},onToogleFullScreen:H,get isExpanded(){return f()},onExpand:()=>i("expanded"),onToggleExpand:he,get onClose(){return e().leaveAndClose}}),null),_(me,(()=>{var ie=q(()=>!!e().joinedRoom());return()=>{var D;return ie()?((D=e())==null?void 0:D.status())??C().modal.connected:C().modal.notConnected}})()),_(ke,(()=>{var ie=q(()=>!!e().joinedRoom());return()=>ie()?[(()=>{var U;var D=Fs();return ae(D,"click",(U=e())==null?void 0:U.toggleMute),_(D,()=>{var Ne;return(Ne=e())!=null&&Ne.isMuted()?"🔇":"🎙️"}),D})(),(()=>{var U;var D=qs();return ae(D,"click",(U=e())==null?void 0:U.leaveRoom),_(D,()=>C().modal.leave),D})()]:(()=>{var D=Vs();return D.$$click=()=>{var U;return(U=e())==null?void 0:U.joinRoom(n.config.rooms[0])},_(D,()=>C().modal.join),D})()})()),S})())]}Ie(["click"]);const Gs="aconsole.log('Hello, world!');";async function Wn(){const n=new TextEncoder,e=await window.crypto.subtle.importKey("raw",n.encode(Gs),{name:"PBKDF2"},!1,["deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:n.encode("consoole.alert.?33312oooo#?"),iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}function Gn(){return window.location.hostname==="192.168.1.151"}async function Ks(n,e,t){const r={data:e,expiresAt:Date.now()+t*1e3},i=JSON.stringify(r);if(Gn()){localStorage.setItem(n,btoa(i));return}const s=new TextEncoder,o=window.crypto.getRandomValues(new Uint8Array(12)),a=await Wn(),c=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},a,s.encode(i)),l=`${btoa(String.fromCharCode(...o))}.${btoa(String.fromCharCode(...new Uint8Array(c)))}`;localStorage.setItem(n,l)}async function Js(n){const e=localStorage.getItem(n);if(!e)return null;try{if(Gn()){const u=atob(e),f=JSON.parse(u);return Date.now()>f.expiresAt?(localStorage.removeItem(n),null):f.data}const[t,r]=e.split(".");if(!t||!r)return null;const i=Uint8Array.from(atob(t),u=>u.charCodeAt(0)),s=Uint8Array.from(atob(r),u=>u.charCodeAt(0)),o=await Wn(),a=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:i},o,s),l=new TextDecoder().decode(a),d=JSON.parse(l);return Date.now()>d.expiresAt?(localStorage.removeItem(n),null):d.data}catch(t){return console.error("Erreur lors du déchiffrement :",t),null}}const Ys="https://talkizi.com/api";function Qs(){return Array.from(document.querySelectorAll("script[src]")).find(n=>n.src.includes("widget.js"))||null}async function Xs(n){const e=await Js("config");if(e)return console.log("✅ Config trouvée dans le cache.",e),e;try{const r=await(await fetch(`${Ys}/configs/validate/${encodeURIComponent(n)}`,{cache:"force-cache"})).json();return r.valid?(await Ks("config",r,3600),r):(console.error("❌ Clé API invalide."),null)}catch(t){return console.error("❌ Erreur API:",t),null}}async function Gt(){const n=Qs();console.log(n);let e=n==null?void 0:n.getAttribute("data-key"),t=n==null?void 0:n.getAttribute("data-show"),r=t===null?!0:t==="true";e||(console.error("❌ API key manquante."),e="Stuc)vW47b.e5?@FGYbj");const i=await Xs(e);if(!i||!i.valid){console.warn("❌ Config invalide ou absente. Rien ne sera affiché.");return}const o=new URLSearchParams(window.location.search).get("talkiziId");o&&(i.talkiziId=o,i.rooms=[{_id:o,name:"Private Room"}]);const a=document.createElement("div");document.body.appendChild(a);{if(console.info("🟣 Mode special actif → rendu uniquement de la modale.",r),!r){bn(()=>[],a);return}bn(()=>L(vi,{get children(){return r&&L(Ws,{config:i})}}),a);return}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Gt):Gt(),window.TalkiziWidget={...window.TalkiziWidget||{},start:Gt,version:"1.0.0-06082025",env:"special"};class Zs{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return eo(e).buffer}}function eo(n){let e=0;for(const i of n)e+=i.byteLength;const t=new Uint8Array(e);let r=0;for(const i of n){const s=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);t.set(s,r),r+=i.byteLength}return t}function Kn(n){return new to(n).unpack()}function Jn(n){const e=new no,t=e.pack(n);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class to{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let r=0,i="",s,o;for(;r<e;)s=t[r],s<160?(o=s,r++):(s^192)<32?(o=(s&31)<<6|t[r+1]&63,r+=2):(s^224)<16?(o=(s&15)<<12|(t[r+1]&63)<<6|t[r+2]&63,r+=3):(o=(s&7)<<18|(t[r+1]&63)<<12|(t[r+2]&63)<<6|t[r+3]&63,r+=4),i+=String.fromCodePoint(o);return this.index+=e,i}unpack_array(e){const t=new Array(e);for(let r=0;r<e;r++)t[r]=this.unpack();return t}unpack_map(e){const t={};for(let r=0;r<e;r++){const i=this.unpack();t[i]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,r=(e>>23&255)-127,i=e&8388607|8388608;return(t===0?1:-1)*i*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),r=e>>31,i=(e>>20&2047)-1023,o=(e&1048575|1048576)*2**(i-20)+t*2**(i-52);return(r===0?1:-1)*o}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class no{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),r=t.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const r=i=>{if(i<t){const s=this.pack(e[i]);return s instanceof Promise?s.then(()=>r(i+1)):r(i+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),i=e/2**r-1,s=Math.floor(i*2**52),o=2**32,a=t<<31|r+1023<<20|s/o&1048575,c=s%o;this._bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(c)}pack_object(e){const t=Object.keys(e),r=t.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const i=s=>{if(s<t.length){const o=t[s];if(e.hasOwnProperty(o)){this.pack(o);const a=this.pack(e[o]);if(a instanceof Promise)return a.then(()=>i(s+1))}return i(s+1)}};return i(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new Zs,this._textEncoder=new TextEncoder}}let Yn=!0,Qn=!0;function He(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function Re(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(o,a){if(o!==e)return i.apply(this,arguments);const c=l=>{const d=t(l);d&&(a.handleEvent?a.handleEvent(d):a(d))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(a,c),i.apply(this,[o,c])};const s=r.removeEventListener;r.removeEventListener=function(o,a){if(o!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(a))return s.apply(this,arguments);const c=this._eventMap[e].get(a);return this._eventMap[e].delete(a),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[o,c])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(o){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),o&&this.addEventListener(e,this["_on"+e]=o)},enumerable:!0,configurable:!0})}function ro(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(Yn=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function io(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(Qn=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function Xn(){if(typeof window=="object"){if(Yn)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Kt(n,e){Qn&&console.warn(n+" is deprecated, please use "+e+" instead.")}function so(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(He(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(He(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(He(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=He(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function Zn(n){return Object.prototype.toString.call(n)==="[object Object]"}function er(n){return Zn(n)?Object.keys(n).reduce(function(e,t){const r=Zn(n[t]),i=r?er(n[t]):n[t],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[t]:i})},{}):n}function Jt(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Jt(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{Jt(n,n.get(i),t)})}))}function tr(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return n.forEach(o=>{o.type==="track"&&o.trackIdentifier===e.id&&s.push(o)}),s.forEach(o=>{n.forEach(a=>{a.type===r&&a.trackId===o.id&&Jt(n,a,i)})}),i}const nr=Xn;function rr(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(a){if(typeof a!="object"||a.mandatory||a.optional)return a;const c={};return Object.keys(a).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const d=typeof a[l]=="object"?a[l]:{ideal:a[l]};d.exact!==void 0&&typeof d.exact=="number"&&(d.min=d.max=d.exact);const u=function(f,m){return f?f+m.charAt(0).toUpperCase()+m.slice(1):m==="deviceId"?"sourceId":m};if(d.ideal!==void 0){c.optional=c.optional||[];let f={};typeof d.ideal=="number"?(f[u("min",l)]=d.ideal,c.optional.push(f),f={},f[u("max",l)]=d.ideal,c.optional.push(f)):(f[u("",l)]=d.ideal,c.optional.push(f))}d.exact!==void 0&&typeof d.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[u("",l)]=d.exact):["min","max"].forEach(f=>{d[f]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[u(f,l)]=d[f])})}),a.advanced&&(c.optional=(c.optional||[]).concat(a.advanced)),c},i=function(a,c){if(e.version>=61)return c(a);if(a=JSON.parse(JSON.stringify(a)),a&&typeof a.audio=="object"){const l=function(d,u,f){u in d&&!(f in d)&&(d[f]=d[u],delete d[u])};a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","googAutoGainControl"),l(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=r(a.audio)}if(a&&typeof a.video=="object"){let l=a.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const d=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!d)){delete a.video.facingMode;let u;if(l.exact==="environment"||l.ideal==="environment"?u=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(u=["front"]),u)return t.mediaDevices.enumerateDevices().then(f=>{f=f.filter(E=>E.kind==="videoinput");let m=f.find(E=>u.some(C=>E.label.toLowerCase().includes(C)));return!m&&f.length&&u.includes("back")&&(m=f[f.length-1]),m&&(a.video.deviceId=l.exact?{exact:m.deviceId}:{ideal:m.deviceId}),a.video=r(a.video),nr("chrome: "+JSON.stringify(a)),c(a)})}a.video=r(a.video)}return nr("chrome: "+JSON.stringify(a)),c(a)},s=function(a){return e.version>=64?a:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraint||a.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},o=function(a,c,l){i(a,d=>{t.webkitGetUserMedia(d,c,u=>{l&&l(s(u))})})};if(t.getUserMedia=o.bind(t),t.mediaDevices.getUserMedia){const a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(c){return i(c,l=>a(l).then(d=>{if(l.audio&&!d.getAudioTracks().length||l.video&&!d.getVideoTracks().length)throw d.getTracks().forEach(u=>{u.stop()}),new DOMException("","NotFoundError");return d},d=>Promise.reject(s(d))))}}}function ir(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function sr(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.track.id):s={track:i.track};const o=new Event("track");o.track=i.track,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)}),r.stream.getTracks().forEach(i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(a=>a.track&&a.track.id===i.id):s={track:i};const o=new Event("track");o.track=i,o.receiver=s,o.transceiver={receiver:s},o.streams=[r.stream],this.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Re(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function or(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(a,c){let l=i.apply(this,arguments);return l||(l=e(this,a),this._senders.push(l)),l};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(a){s.apply(this,arguments);const c=this._senders.indexOf(a);c!==-1&&this._senders.splice(c,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],t.apply(this,[s]),s.getTracks().forEach(o=>{this._senders.push(e(this,o))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(o=>{const a=this._senders.find(c=>c.track===o);a&&this._senders.splice(this._senders.indexOf(a),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function ar(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(o=>o._pc=this),s});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),n.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(o=>tr(o,s.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(s=>s._pc=this),i}),Re(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>tr(s,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,s,o;return this.getSenders().forEach(a=>{a.track===r&&(i?o=!0:i=a)}),this.getReceivers().forEach(a=>(a.track===r&&(s?o=!0:s=a),a.track===r)),o||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function cr(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(o=>this._shimmedLocalStreams[o][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(o,a){if(!a)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[a.id]?this._shimmedLocalStreams[a.id].indexOf(c)===-1&&this._shimmedLocalStreams[a.id].push(c):this._shimmedLocalStreams[a.id]=[a,c],c};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(o){this._shimmedLocalStreams=this._shimmedLocalStreams||{},o.getTracks().forEach(l=>{if(this.getSenders().find(u=>u.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const a=this.getSenders();t.apply(this,arguments);const c=this.getSenders().filter(l=>a.indexOf(l)===-1);this._shimmedLocalStreams[o.id]=[o].concat(c)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[o.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(o){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},o&&Object.keys(this._shimmedLocalStreams).forEach(a=>{const c=this._shimmedLocalStreams[a].indexOf(o);c!==-1&&this._shimmedLocalStreams[a].splice(c,1),this._shimmedLocalStreams[a].length===1&&delete this._shimmedLocalStreams[a]}),i.apply(this,arguments)}}function lr(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return cr(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const d=t.apply(this);return this._reverseStreams=this._reverseStreams||{},d.map(u=>this._reverseStreams[u.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(d){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.getTracks().forEach(u=>{if(this.getSenders().find(m=>m.track===u))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[d.id]){const u=new n.MediaStream(d.getTracks());this._streams[d.id]=u,this._reverseStreams[u.id]=d,d=u}r.apply(this,[d])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(d){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[d.id]||d]),delete this._reverseStreams[this._streams[d.id]?this._streams[d.id].id:d.id],delete this._streams[d.id]},n.RTCPeerConnection.prototype.addTrack=function(d,u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const f=[].slice.call(arguments,1);if(f.length!==1||!f[0].getTracks().find(C=>C===d))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(C=>C.track===d))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const E=this._streams[u.id];if(E)E.addTrack(d),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const C=new n.MediaStream([d]);this._streams[u.id]=C,this._reverseStreams[C.id]=u,this.addStream(C)}return this.getSenders().find(C=>C.track===d)};function s(l,d){let u=d.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const m=l._reverseStreams[f],E=l._streams[m.id];u=u.replace(new RegExp(E.id,"g"),m.id)}),new RTCSessionDescription({type:d.type,sdp:u})}function o(l,d){let u=d.sdp;return Object.keys(l._reverseStreams||[]).forEach(f=>{const m=l._reverseStreams[f],E=l._streams[m.id];u=u.replace(new RegExp(m.id,"g"),E.id)}),new RTCSessionDescription({type:d.type,sdp:u})}["createOffer","createAnswer"].forEach(function(l){const d=n.RTCPeerConnection.prototype[l],u={[l](){const f=arguments;return arguments.length&&typeof arguments[0]=="function"?d.apply(this,[E=>{const C=s(this,E);f[0].apply(null,[C])},E=>{f[1]&&f[1].apply(null,E)},arguments[2]]):d.apply(this,arguments).then(E=>s(this,E))}};n.RTCPeerConnection.prototype[l]=u[l]});const a=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?a.apply(this,arguments):(arguments[0]=o(this,arguments[0]),a.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),n.RTCPeerConnection.prototype.removeTrack=function(d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!d._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(d._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let f;Object.keys(this._streams).forEach(m=>{this._streams[m].getTracks().find(C=>d.track===C)&&(f=this._streams[m])}),f&&(f.getTracks().length===1?this.removeStream(this._reverseStreams[f.id]):f.removeTrack(d.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Yt(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function ur(n,e){Re(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}const dr=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:ur,shimAddTrackRemoveTrack:lr,shimAddTrackRemoveTrackWithNative:cr,shimGetSendersWithDtmf:or,shimGetUserMedia:rr,shimMediaStream:ir,shimOnTrack:sr,shimPeerConnection:Yt,shimSenderReceiverGetStats:ar},Symbol.toStringTag,{value:"Module"}));function fr(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,s,o){Kt("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(s,o)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(o,a,c){a in o&&!(c in o)&&(o[c]=o[a],delete o[a])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(o){return typeof o=="object"&&typeof o.audio=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o.audio,"autoGainControl","mozAutoGainControl"),i(o.audio,"noiseSuppression","mozNoiseSuppression")),s(o)},r&&r.prototype.getSettings){const o=r.prototype.getSettings;r.prototype.getSettings=function(){const a=o.apply(this,arguments);return i(a,"mozAutoGainControl","autoGainControl"),i(a,"mozNoiseSuppression","noiseSuppression"),a}}if(r&&r.prototype.applyConstraints){const o=r.prototype.applyConstraints;r.prototype.applyConstraints=function(a){return this.kind==="audio"&&typeof a=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a,"autoGainControl","mozAutoGainControl"),i(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}}function oo(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function hr(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Qt(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=n.RTCPeerConnection.prototype[i],o={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=o[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[s,o,a]=arguments;return r.apply(this,[s||null]).then(c=>{if(e.version<53&&!o)try{c.forEach(l=>{l.type=t[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((d,u)=>{c.set(u,Object.assign({},d,{type:t[d.type]||d.type}))})}return c}).then(o,a)}}function pr(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function mr(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),Re(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function gr(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){Kt("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function yr(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function vr(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(o=>{if("rid"in o&&!/^[a-z0-9]{0,16}$/i.test(o.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in o&&!(parseFloat(o.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in o&&!(parseFloat(o.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:o}=s,a=o.getParameters();(!("encodings"in a)||a.encodings.length===1&&Object.keys(a.encodings[0]).length===0)&&(a.encodings=r,o.sendEncodings=r,this.setParametersPromises.push(o.setParameters(a).then(()=>{delete o.sendEncodings}).catch(()=>{delete o.sendEncodings})))}return s})}function _r(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function br(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Cr(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const Sr=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:vr,shimCreateAnswer:Cr,shimCreateOffer:br,shimGetDisplayMedia:oo,shimGetParameters:_r,shimGetUserMedia:fr,shimOnTrack:hr,shimPeerConnection:Qt,shimRTCDataChannel:yr,shimReceiverGetStats:mr,shimRemoveStream:gr,shimSenderGetStats:pr},Symbol.toStringTag,{value:"Module"}));function kr(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r,...i){return i&&i.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function xr(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const o=new Event("addstream");o.stream=s,r.dispatchEvent(o)})}),e.apply(r,arguments)}}}function Tr(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(l,d){const u=arguments.length>=2?arguments[2]:arguments[0],f=t.apply(this,[u]);return d?(f.then(l,d),Promise.resolve()):f},e.createAnswer=function(l,d){const u=arguments.length>=2?arguments[2]:arguments[0],f=r.apply(this,[u]);return d?(f.then(l,d),Promise.resolve()):f};let a=function(c,l,d){const u=i.apply(this,[c]);return d?(u.then(l,d),Promise.resolve()):u};e.setLocalDescription=a,a=function(c,l,d){const u=s.apply(this,[c]);return d?(u.then(l,d),Promise.resolve()):u},e.setRemoteDescription=a,a=function(c,l,d){const u=o.apply(this,[c]);return d?(u.then(l,d),Promise.resolve()):u},e.addIceCandidate=a}function Rr(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(Er(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function Er(n){return n&&n.video!==void 0?Object.assign({},n,{video:er(n.video)}):n}function wr(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let o=0;o<r.iceServers.length;o++){let a=r.iceServers[o];a.urls===void 0&&a.url?(Kt("RTCIceServer.url","RTCIceServer.urls"),a=JSON.parse(JSON.stringify(a)),a.urls=a.url,delete a.url,s.push(a)):s.push(r.iceServers[o])}r.iceServers=s}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Pr(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Ar(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(o=>o.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(o=>o.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Or(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}const Lr=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Or,shimCallbacksAPI:Tr,shimConstraints:Er,shimCreateOfferLegacy:Ar,shimGetUserMedia:Rr,shimLocalStreamsAPI:kr,shimRTCIceServerUrls:wr,shimRemoteStreamsAPI:xr,shimTrackEventTransceiver:Pr},Symbol.toStringTag,{value:"Module"}));function ao(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Xt={exports:{}},Ir;function co(){return Ir||(Ir=1,function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const s=t.type;return r.push("typ"),r.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const s=t.substring(t.indexOf(" ")+1).split(";");for(let o=0;o<s.length;o++)i=s[o].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(o=>{t.parameters[o]!==void 0?s.push(o+"="+t.parameters[o]):s.push(o)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},s=t.indexOf(":",r);return s>-1?(i.attribute=t.substring(r+1,s),i.value=t.substring(s+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(t)[0].split(" ");r.profile=s[2];for(let a=3;a<s.length;a++){const c=s[a],l=e.matchPrefix(t,"a=rtpmap:"+c+" ")[0];if(l){const d=e.parseRtpMap(l),u=e.matchPrefix(t,"a=fmtp:"+c+" ");switch(d.parameters=u.length?e.parseFmtp(u[0]):{},d.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),r.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(d.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(a=>{r.headerExtensions.push(e.parseExtmap(a))});const o=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(a=>{o.forEach(c=>{a.rtcpFeedback.find(d=>d.type===c.type&&d.parameter===c.parameter)||a.rtcpFeedback.push(c)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(o=>o.preferredPayloadType!==void 0?o.preferredPayloadType:o.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(o=>{i+=e.writeRtpMap(o),i+=e.writeFmtp(o),i+=e.writeRtcpFb(o)});let s=0;return r.codecs.forEach(o=>{o.maxptime>s&&(s=o.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(o=>{i+=e.writeExtmap(o)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),s=i.fecMechanisms.indexOf("RED")!==-1,o=i.fecMechanisms.indexOf("ULPFEC")!==-1,a=e.matchPrefix(t,"a=ssrc:").map(f=>e.parseSsrcMedia(f)).filter(f=>f.attribute==="cname"),c=a.length>0&&a[0].ssrc;let l;const d=e.matchPrefix(t,"a=ssrc-group:FID").map(f=>f.substring(17).split(" ").map(E=>parseInt(E,10)));d.length>0&&d[0].length>1&&d[0][0]===c&&(l=d[0][1]),i.codecs.forEach(f=>{if(f.name.toUpperCase()==="RTX"&&f.parameters.apt){let m={ssrc:c,codecPayloadType:parseInt(f.parameters.apt,10)};c&&l&&(m.rtx={ssrc:l}),r.push(m),s&&(m=JSON.parse(JSON.stringify(m)),m.fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(m))}}),r.length===0&&c&&r.push({ssrc:c});let u=e.matchPrefix(t,"b=");return u.length&&(u[0].indexOf("b=TIAS:")===0?u=parseInt(u[0].substring(7),10):u[0].indexOf("b=AS:")===0?u=parseInt(u[0].substring(5),10)*1e3*.95-50*40*8:u=void 0,r.forEach(f=>{f.maxBitrate=u})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const o=e.matchPrefix(t,"a=rtcp-mux");return r.mux=o.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(t,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const o=e.matchPrefix(t,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const a=e.matchPrefix(t,"a=sctpmap:");if(a.length>0){const c=a[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let s;const o=r!==void 0?r:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e}(Xt)),Xt.exports}var Dr=co();const Be=ao(Dr),lo=xe({__proto__:null,default:Be},[Dr]);function gt(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=Be.parseCandidate(r.candidate);for(const o in s)o in i||Object.defineProperty(i,o,{value:s[o]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,Re(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Zt(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||Re(n,"icecandidate",e=>{if(e.candidate){const t=Be.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function yt(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(a){if(!a||!a.sdp)return!1;const c=Be.splitSections(a.sdp);return c.shift(),c.some(l=>{const d=Be.parseMLine(l);return d&&d.kind==="application"&&d.protocol.indexOf("SCTP")!==-1})},r=function(a){const c=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},i=function(a){let c=65536;return e.browser==="firefox"&&(e.version<57?a===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(a,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const d=Be.matchPrefix(a.sdp,"a=max-message-size:");return d.length>0?l=parseInt(d[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},o=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const c=r(arguments[0]),l=i(c),d=s(arguments[0],c);let u;l===0&&d===0?u=Number.POSITIVE_INFINITY:l===0||d===0?u=Math.max(l,d):u=Math.min(l,d);const f={};Object.defineProperty(f,"maxMessageSize",{get(){return u}}),this._sctp=f}return o.apply(this,arguments)}}function vt(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const a=arguments[0],c=a.length||a.size||a.byteLength;if(r.readyState==="open"&&i.sctp&&c>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},Re(n,"datachannel",r=>(e(r.channel,r.target),r))}function en(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const o=new Event("connectionstatechange",i);s.dispatchEvent(o)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function tn(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(o=>o.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return t.apply(this,arguments)}}function _t(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function bt(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(o=>t.apply(this,[o]))})}const uo=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:tn,shimAddIceCandidateNullOrEmpty:_t,shimConnectionState:en,shimMaxMessageSize:yt,shimParameterlessSetLocalDescription:bt,shimRTCIceCandidate:gt,shimRTCIceCandidateRelayProtocol:Zt,shimSendThrowTypeError:vt},Symbol.toStringTag,{value:"Module"}));function fo({window:n}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=Xn,r=so(n),i={browserDetails:r,commonShim:uo,extractVersion:He,disableLog:ro,disableWarnings:io,sdp:lo};switch(r.browser){case"chrome":if(!dr||!Yt||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=dr,_t(n,r),bt(n),rr(n,r),ir(n),Yt(n,r),sr(n),lr(n,r),or(n),ar(n),ur(n,r),gt(n),Zt(n),en(n),yt(n,r),vt(n),tn(n,r);break;case"firefox":if(!Sr||!Qt||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=Sr,_t(n,r),bt(n),fr(n,r),Qt(n,r),hr(n),gr(n),pr(n),mr(n),yr(n),vr(n),_r(n),br(n),Cr(n),gt(n),en(n),yt(n,r),vt(n);break;case"safari":if(!Lr||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=Lr,_t(n,r),bt(n),wr(n),Ar(n),Tr(n),kr(n),xr(n),Pr(n),Rr(n),Or(n),gt(n),Zt(n),yt(n,r),vt(n),tn(n,r);break;default:t("Unsupported browser!");break}return i}const $r=fo({window:typeof window>"u"?void 0:window});function Ee(n,e,t,r){Object.defineProperty(n,e,{get:t,set:r,enumerable:!0,configurable:!0})}class Mr{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],r=e.byteLength,i=Math.ceil(r/this.chunkedMTU);let s=0,o=0;for(;o<r;){const a=Math.min(r,o+this.chunkedMTU),c=e.slice(o,a),l={__peerData:this._dataCount,n:s,data:c,total:i};t.push(l),o=a,s++}return this._dataCount++,t}}}function ho(n){let e=0;for(const i of n)e+=i.byteLength;const t=new Uint8Array(e);let r=0;for(const i of n)t.set(i,r),r+=i.byteLength;return t}const nn=$r.default||$r,We=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const n=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(n)?n==="chrome"?e>=this.minChromeVersion:n==="firefox"?e>=this.minFirefoxVersion:n==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return nn.browserDetails.browser}getVersion(){return nn.browserDetails.version||0}isUnifiedPlanSupported(){const n=this.getBrowser(),e=nn.browserDetails.version||0;if(n==="chrome"&&e<this.minChromeVersion)return!1;if(n==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,r=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),r=!0}catch{}finally{t&&t.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},po=n=>!n||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(n),Br=()=>Math.random().toString(36).slice(2),Nr={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class mo extends Mr{noop(){}blobToArrayBuffer(e,t){const r=new FileReader;return r.onload=function(i){i.target&&t(i.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=Nr,this.browser=We.getBrowser(),this.browserVersion=We.getVersion(),this.pack=Jn,this.unpack=Kn,this.supports=function(){const t={browser:We.isBrowserSupported(),webRTC:We.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let r;try{r=new RTCPeerConnection(Nr),t.audioVideo=!0;let i;try{i=r.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!i.ordered;try{i.binaryType="blob",t.binaryBlob=!We.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{r&&r.close()}return t}(),this.validateId=po,this.randomToken=Br}}const Y=new mo,go="PeerJS: ";class yo{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const r=[go,...t];for(const i in r)r[i]instanceof Error&&(r[i]="("+r[i].name+") "+r[i].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var h=new yo,rn={},vo=Object.prototype.hasOwnProperty,Q="~";function Ge(){}Object.create&&(Ge.prototype=Object.create(null),new Ge().__proto__||(Q=!1));function _o(n,e,t){this.fn=n,this.context=e,this.once=t||!1}function jr(n,e,t,r,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new _o(t,r||n,i),o=Q?Q+e:e;return n._events[o]?n._events[o].fn?n._events[o]=[n._events[o],s]:n._events[o].push(s):(n._events[o]=s,n._eventsCount++),n}function Ct(n,e){--n._eventsCount===0?n._events=new Ge:delete n._events[e]}function G(){this._events=new Ge,this._eventsCount=0}G.prototype.eventNames=function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)vo.call(t,r)&&e.push(Q?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},G.prototype.listeners=function(e){var t=Q?Q+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},G.prototype.listenerCount=function(e){var t=Q?Q+e:e,r=this._events[t];return r?r.fn?1:r.length:0},G.prototype.emit=function(e,t,r,i,s,o){var a=Q?Q+e:e;if(!this._events[a])return!1;var c=this._events[a],l=arguments.length,d,u;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,s),!0;case 6:return c.fn.call(c.context,t,r,i,s,o),!0}for(u=1,d=new Array(l-1);u<l;u++)d[u-1]=arguments[u];c.fn.apply(c.context,d)}else{var f=c.length,m;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),l){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,i);break;default:if(!d)for(m=1,d=new Array(l-1);m<l;m++)d[m-1]=arguments[m];c[u].fn.apply(c[u].context,d)}}return!0},G.prototype.on=function(e,t,r){return jr(this,e,t,r,!1)},G.prototype.once=function(e,t,r){return jr(this,e,t,r,!0)},G.prototype.removeListener=function(e,t,r,i){var s=Q?Q+e:e;if(!this._events[s])return this;if(!t)return Ct(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!i||o.once)&&(!r||o.context===r)&&Ct(this,s);else{for(var a=0,c=[],l=o.length;a<l;a++)(o[a].fn!==t||i&&!o[a].once||r&&o[a].context!==r)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:Ct(this,s)}return this},G.prototype.removeAllListeners=function(e){var t;return e?(t=Q?Q+e:e,this._events[t]&&Ct(this,t)):(this._events=new Ge,this._eventsCount=0),this},G.prototype.off=G.prototype.removeListener,G.prototype.addListener=G.prototype.on,G.prefixed=Q,G.EventEmitter=G,rn=G;var we={};Ee(we,"ConnectionType",()=>_e),Ee(we,"PeerErrorType",()=>M),Ee(we,"BaseConnectionErrorType",()=>St),Ee(we,"DataConnectionErrorType",()=>kt),Ee(we,"SerializationType",()=>Ke),Ee(we,"SocketEventType",()=>be),Ee(we,"ServerMessageType",()=>V);var _e=function(n){return n.Data="data",n.Media="media",n}({}),M=function(n){return n.BrowserIncompatible="browser-incompatible",n.Disconnected="disconnected",n.InvalidID="invalid-id",n.InvalidKey="invalid-key",n.Network="network",n.PeerUnavailable="peer-unavailable",n.SslUnavailable="ssl-unavailable",n.ServerError="server-error",n.SocketError="socket-error",n.SocketClosed="socket-closed",n.UnavailableID="unavailable-id",n.WebRTC="webrtc",n}({}),St=function(n){return n.NegotiationFailed="negotiation-failed",n.ConnectionClosed="connection-closed",n}({}),kt=function(n){return n.NotOpenYet="not-open-yet",n.MessageToBig="message-too-big",n}({}),Ke=function(n){return n.Binary="binary",n.BinaryUTF8="binary-utf8",n.JSON="json",n.None="raw",n}({}),be=function(n){return n.Message="message",n.Disconnected="disconnected",n.Error="error",n.Close="close",n}({}),V=function(n){return n.Heartbeat="HEARTBEAT",n.Candidate="CANDIDATE",n.Offer="OFFER",n.Answer="ANSWER",n.Open="OPEN",n.Error="ERROR",n.IdTaken="ID-TAKEN",n.InvalidKey="INVALID-KEY",n.Leave="LEAVE",n.Expire="EXPIRE",n}({});const zr="1.5.5";class bo extends rn.EventEmitter{constructor(e,t,r,i,s,o=5e3){super(),this.pingInterval=o,this._disconnected=!0,this._messagesQueue=[];const a=e?"wss://":"ws://";this._baseUrl=a+t+":"+r+i+"peerjs?key="+s}start(e,t){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+zr),this._disconnected=!1,this._socket.onmessage=i=>{let s;try{s=JSON.parse(i.data),h.log("Server message received:",s)}catch{h.log("Invalid server message",i.data);return}this.emit(be.Message,s)},this._socket.onclose=i=>{this._disconnected||(h.log("Socket closed.",i),this._cleanup(),this._disconnected=!0,this.emit(be.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),h.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){h.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:V.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(be.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class Ur{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===_e.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const r=this.connection,i={ordered:!!e.reliable},s=t.createDataChannel(r.label,i);r._initializeDataChannel(s),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){h.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,s=this.connection.provider;h.log("Listening for ICE candidates."),e.onicecandidate=o=>{!o.candidate||!o.candidate.candidate||(h.log(`Received ICE candidates for ${t}:`,o.candidate),s.socket.send({type:V.Candidate,payload:{candidate:o.candidate,type:i,connectionId:r},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":h.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(St.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":h.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(St.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":h.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},h.log("Listening for data channel"),e.ondatachannel=o=>{h.log("Received data channel");const a=o.channel;s.getConnection(t,r)._initializeDataChannel(a)},h.log("Listening for remote stream"),e.ontrack=o=>{h.log("Received remote stream");const a=o.streams[0],c=s.getConnection(t,r);if(c.type===_e.Media){const l=c;this._addStreamToMediaConnection(a,l)}}}cleanup(){h.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let r=!1;const i=this.connection.dataChannel;i&&(r=!!i.readyState&&i.readyState!=="closed"),(t||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);h.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),h.log("Set localDescription:",r,`for:${this.connection.peer}`);let i={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===_e.Data){const s=this.connection;i={...i,label:s.label,reliable:s.reliable,serialization:s.serialization}}t.socket.send({type:V.Offer,payload:i,dst:this.connection.peer})}catch(i){i!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(M.WebRTC,i),h.log("Failed to setLocalDescription, ",i))}}catch(r){t.emitError(M.WebRTC,r),h.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createAnswer();h.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),h.log("Set localDescription:",r,`for:${this.connection.peer}`),t.socket.send({type:V.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(i){t.emitError(M.WebRTC,i),h.log("Failed to setLocalDescription, ",i)}}catch(r){t.emitError(M.WebRTC,r),h.log("Failed to create answer, ",r)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const r=this.connection.peerConnection,i=this.connection.provider;h.log("Setting remote description",t);const s=this;try{await r.setRemoteDescription(t),h.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await s._makeAnswer()}catch(o){i.emitError(M.WebRTC,o),h.log("Failed to setRemoteDescription, ",o)}}async handleCandidate(e){h.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),h.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(M.WebRTC,t),h.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(h.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return h.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{t.addTrack(r,e)})}_addStreamToMediaConnection(e,t){h.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class Fr extends rn.EventEmitter{emitError(e,t){h.error("Error:",t),this.emit("error",new qr(`${e}`,t))}}class qr extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class Vr extends Fr{get open(){return this._open}constructor(e,t,r){super(),this.peer=e,this.provider=t,this.options=r,this._open=!1,this.metadata=r.metadata}}const Je=class Je extends Vr{get type(){return _e.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,r){super(e,t,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||Je.ID_PREFIX+Y.randomToken(),this._negotiator=new Ur(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{h.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{h.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){h.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,r=e.payload;switch(e.type){case V.Answer:this._negotiator.handleSDP(t,r.sdp),this._open=!0;break;case V.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:h.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){h.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const i of r)this.handleMessage(i);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};an=new WeakMap,Xe(Je,an,Je.ID_PREFIX="mc_");let xt=Je;class Co{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:r,port:i,path:s,key:o}=this._options,a=new URL(`${t}://${r}:${i}${s}${o}/${e}`);return a.searchParams.set("ts",`${Date.now()}${Math.random()}`),a.searchParams.set("version",zr),fetch(a.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){h.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==Y.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===Y.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw h.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}const Pe=class Pe extends Vr{get type(){return _e.Data}constructor(e,t,r){super(e,t,r),this.connectionId=this.options.connectionId||Pe.ID_PREFIX+Br(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new Ur(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{h.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{h.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{h.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(kt.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case V.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case V.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:h.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};cn=new WeakMap,ln=new WeakMap,Xe(Pe,cn,Pe.ID_PREFIX="dc_"),Xe(Pe,ln,Pe.MAX_BUFFERED_AMOUNT=8388608);let Tt=Pe;class Rt extends Tt{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>Tt.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return h.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class sn extends Rt{close(e){super.close(e),this._chunkedData={}}constructor(e,t,r){super(e,t,r),this.chunker=new Mr,this.serialization=Ke.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=Kn(e),r=t.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,r=this._chunkedData[t]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[t]=r,r.total===r.count){delete this._chunkedData[t];const i=ho(r.data);this._handleDataMessage({data:i})}}_send(e,t){const r=Jn(e);if(r instanceof Promise)return this._send_blob(r);if(!t&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);h.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const r of t)this.send(r,!0)}}class So extends Rt{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=Ke.None}}class ko extends Rt{_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),r=t.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=Y.chunkedMTU){this.emitError(kt.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=Ke.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}const Ye=class Ye extends Fr{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,r]of this._connections)e[t]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:So,json:ko,binary:sn,"binary-utf8":sn,default:sn},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?t=e:e&&(r=e.toString()),t={debug:0,host:Y.CLOUD_HOST,port:Y.CLOUD_PORT,path:"/",key:Ye.DEFAULT_KEY,token:Y.randomToken(),config:Y.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Y.CLOUD_HOST?this._options.secure=Y.isSecure():this._options.host==Y.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&h.setLogFunction(this._options.logFunction),h.logLevel=this._options.debug||0,this._api=new Co(t),this._socket=this._createServerConnection(),!Y.supports.audioVideo&&!Y.supports.data){this._delayedAbort(M.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!Y.validateId(r)){this._delayedAbort(M.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(i=>this._initialize(i)).catch(i=>this._abort(M.ServerError,i))}_createServerConnection(){const e=new bo(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(be.Message,t=>{this._handleMessage(t)}),e.on(be.Error,t=>{this._abort(M.SocketError,t)}),e.on(be.Disconnected,()=>{this.disconnected||(this.emitError(M.Network,"Lost connection to server."),this.disconnect())}),e.on(be.Close,()=>{this.disconnected||this._abort(M.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,r=e.payload,i=e.src;switch(t){case V.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case V.Error:this._abort(M.ServerError,r.msg);break;case V.IdTaken:this._abort(M.UnavailableID,`ID "${this.id}" is taken`);break;case V.InvalidKey:this._abort(M.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case V.Leave:h.log(`Received leave message from ${i}`),this._cleanupPeer(i),this._connections.delete(i);break;case V.Expire:this.emitError(M.PeerUnavailable,`Could not connect to peer ${i}`);break;case V.Offer:{const s=r.connectionId;let o=this.getConnection(i,s);if(o&&(o.close(),h.warn(`Offer received for existing Connection ID:${s}`)),r.type===_e.Media){const c=new xt(i,this,{connectionId:s,_payload:r,metadata:r.metadata});o=c,this._addConnection(i,o),this.emit("call",c)}else if(r.type===_e.Data){const c=new this._serializers[r.serialization](i,this,{connectionId:s,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});o=c,this._addConnection(i,o),this.emit("connection",c)}else{h.warn(`Received malformed connection type:${r.type}`);return}const a=this._getMessages(s);for(const c of a)o.handleMessage(c);break}default:{if(!r){h.warn(`You received a malformed message from ${i} of type ${t}`);return}const s=r.connectionId,o=this.getConnection(i,s);o&&o.peerConnection?o.handleMessage(e):s?this._storeMessage(s,e):h.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){h.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(M.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,r),r}call(e,t,r={}){if(this.disconnected){h.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(M.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){h.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const i=new xt(e,this,{...r,_stream:t});return this._addConnection(e,i),i}_addConnection(e,t){h.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const r=t.indexOf(e);r!==-1&&t.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const r=this._connections.get(e);if(!r)return null;for(const i of r)if(i.connectionId===t)return i;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){h.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(h.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const r of t)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;h.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)h.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)h.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(M.ServerError,t))}};un=new WeakMap,Xe(Ye,un,Ye.DEFAULT_KEY="peerjs");let on=Ye;const xo=Object.freeze(Object.defineProperty({__proto__:null,BaseConnectionErrorType:St,BufferedConnection:Rt,ConnectionType:_e,DataConnectionErrorType:kt,Peer:on,PeerError:qr,PeerErrorType:M,SerializationType:Ke,ServerMessageType:V,SocketEventType:be,util:Y},Symbol.toStringTag,{value:"Module"}))})();
